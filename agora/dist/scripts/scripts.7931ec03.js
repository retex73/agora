function activityClick(a){switch(a.displayName){case"Render Viz":renderViz();break;case"Render Viz with more Options":renderVizMoreOptions();break;case"Dispose viz":dispose();break;case"Hide Viz":hideViz();break;case"Show Viz":showViz();break;case"Show Toolbar":showToolbar();break;case"Hide Toolbar":hideToolbar();break;case"Viz Property: AreToolbarsHidden":areToolbarsHidden();break;case"Viz Property: AreTabsHidden":areTabssHidden();break;case"Download Workbook":showDownloadWorkbook();break;case"Export Crosstab":showExportCrosstabDialog();break;case"Export Data":exportData();break;case"Export Image":exportImage();break;case"Export PDF":exportPDF();break;case"Viz Property: IsHidden":getIsVizHidden();break;case"Viz Property: AreAutomaticUpdatesPaused":getAreAutomaticUpdatesPaused();break;case"Viz Property: ParentElement":getParentElement();break;case"Viz Property: Url":getURL();break;case"Viz Property: Workbook":getWorkbook();break;case"Pause automatic updates":pauseAutomaticUpdatesAsync();break;case"Refresh Data":refreshData();break;case"Resume automatic updates":resumeAutomaticUpdates();break;case"Revert All":revertAll();break;case"Set frame size":setFrameSize();break;case"Show share dialog":showShareDialog();break;case"Toggle automatic updates":toggleAutomaticUpdates();break;case"Activate event listeners":activateEventListeners();break;case"Deactivate event listeners":deactivateEventListeners();break;case"Change Parameter Value Async":changeParameterValueAsync();break;case"Revert all async":revertAllAsync();break;case"Save as custom view named 'test'":rememberCustomViewAsync();break;case"Remove custom view 'test'":removeCustomViewAsync();break;case"Show custom view 'test'":showCustomViewAsync();break;case"Set active view as default":setActiveCustomViewAsDefaultAsync();break;case"WB Property: ActiveCustomView":getActiveCustomView();break;case"WB Property: ActiveSheet":getActiveSheet();break;case"WB Property: Name":getName();break;case"WB Property: Parameters":getParametersAsync();break;case"WB Property: PublishedSheetsInfo":getPublishedSheetsInfo();break;case"Create Custom View":customView();break;case"Save Custom View":saveAsync();break;case"Share Custom View":setAdvertised();break;case"Rename Custom View":setName();break;case"Show Custom View":showAsync();break;case"Set Active Sheet - Range Example":activateSheetRange();break;case"Set Active Sheet - Categorical Example":activateSheetCategorical();break;case"Set Active Sheet - Date Period":activateSheetDatePeriod();break;case"Set Active Sheet - Relative Date":activateSheetRelative();break;case"Apply Hierarchical Filter":applyHierarchicalFilterAsync();break;case"Apply Categorical Filter":applyFilterAsync();break;case"Remove and Add a Categorical Filter":applyFilterMoreAsync();break;case"Apply All to Categorical Filter":applyAll();break;case"Apply Date Period Date Filter":applyDatePeriodFilter();break;case"Apply Range Filter":applyRangeFilterAsync();break;case"Apply Relative Date Filter":applyRelativeDateFilterAsync();break;case"Clear Hierarchical Filter":clearHierarchicalFilter();break;case"Clear Categorical":clearCategorical();break;case"Clear Range Filter":clearRangeFilter();break;case"Clear Relative Date Filter":clearRelativeDateFilter();break;case"Select Marks Inside Dashboard":selectMarksInsideDashboard();break;case"Select Marks":selectMarksAsync();break;case"Select More Marks":selectMoreMarksAsync();break;case"Select Marks using two dimensions":selectMarksTwoDimensionsAsync();break;case"Clear Marks":clearMarksAsync();break;case"Change Size":changeSizeAsync();break;case"Sheet Property: DataSources":getDataSourcesAsync();break;case"Sheet Property: Filters":getFiltersAsync();break;case"Sheet Property: Index":sheet_getIndex();break;case"Sheet Property: IsActive":sheet_getIsActive();break;case"Sheet Property: IsHidden":sheet_getIsHidden();break;case"Sheet Property: Name":sheet_getName();break;case"Sheet Property: Objects":sheet_getObjects();break;case"Sheet Property: ParentDashboard":getParentDashboard();break;case"Sheet Property: Repository Url":sheet_getRepositoryUrl();break;case"Sheet Property: Selected Marks":getSelectedMarksAsync();break;case"Sheet Property: Sheet Type":getSheetType();break;case"Sheet Property: Sheet Size":getSize();break;case"Sheet Property: Workbook":sheet_getWorkbook();break;case"Get Data Source":getDataSources();break;case"Fetch Fields":getFields();break;case"Data Source Property: IsPrimary":getIsPrimary();break;case"Date Source Property: Name":dataSourceGetName();break;case"Get Dashboard Objects":getObjects();break;case"Get Worksheets":getWorksheets();break;case"changeSizeAsync() - Story":changeStorySizeAsync();break;case"activateStoryPointAsync()":activateStoryPointAsync();break;case"activateNextStoryPointAsync()":activateNextStoryPointAsync();break;case"activatePreviousStoryPointAsync()":activatePreviousStoryPointAsync();break;case"revertStoryPointAsync()":revertStoryPointAsync();break;case"Story Property: Name":story_getName();break;case"Story Property: Index":story_getIndex();break;case"Story Property: isActive":story_getIsActive();break;case"Story Property: isHidden":story_getIsHidden();break;case"Story Property: Story Type":story_getType();break;case"Story Property: Story Size":getSize();break;case"Story Property: Url":getURL();break;case"Story Property: Workbook":story_getWorkbook();break;case"Story Property: StoryPointsInfo":getStoryPointsInfo();break;case"Story Property: ActiveStoryPoint":getActiveStoryPoint();break;case"StoryPoint Property - Index":storyPoint_getIndexAndCaption();break;case"StoryPoint Property - Caption":storyPoint_getIndexAndCaption();break;case"StoryPoint Property - IsActive":storyPoint_getIsActive();break;case"StoryPoint Property - IsUpdated":storyPoint_getIsUpdated();break;case"StoryPoint Property - ContainedSheet":storyPoint_getContainedSheet();break;case"StoryPoint Property - ParentStory":storyPoint_getParentStory();break;case"StoryPointInfo Property - Index":storyPointInfo_getIndexAndCaption();break;case"StoryPointInfo Property - Caption":storyPointInfo_getIndexAndCaption();break;case"StoryPointInfo Property - IsActive":storyPointInfo_getIsActive();break;case"StoryPointInfo Property - IsUpdated":storyPointInfo_getIsUpdated();break;case"StoryPointInfo Property - ParentStory":storyPointInfo_getParentStory();break;case"Get Parameters":parameters_getParametersAsync();break;case"Parameter Property: CurrentValue":parameters_getCurrentValue();break;case"Parameter Property: DataType":parameters_getDataType();break;case"Parameter Property: AllowableValuesType":parameters_getAllowableValuesType();break;case"Parameter Property: AllowableValues":parameters_getAllowableValues();break;case"Parameter Property: MinimumValue":parameters_getMinMaxValue();break;case"Parameter Property: MaximumValue":parameters_getMinMaxValue();break;case"Parameter Property: StepSize":parameters_getStepSize();break;case"Parameter Property: DateStepPeriod":parameters_getDateStepPeriod();break;case"Examine Parameter #1":parametersDate();break;case"Examine Parameter #2":parametersString();break;case"Examine Parameter #3":parametersNumeric();break;case"Get Filters":getFiltersAsyncAgain();break;case"Filter Property: Applied Values - #1":filterCategoricalAppliedValues();break;case"Filter Property: Field - #1":filterCategoricalField();break;case"Filter Property: FieldName - #1":filterCategoricalFieldName();break;case"Filter Property: FilterType - #1":filterCategoricalFilterType();break;case"Filter Property: IsExcludeMode - #1":filterCategoricalIsExcludeMode();break;case"Filter Property: Worksheet - #1":filterCategoricalWorksheet();break;case"Filter Property: DomainMinValue - #2":filterQuantitativeDomainMinValue();break;case"Filter Property: DomainMaxValue - #2":filterQuantitativeDomainMaxValue();break;case"Filter Property: MinValue - #2":filterQuantitativeMinValue();break;case"Filter Property: MaxValue - #2":filterQuantitativeMaxValue();break;case"Filter Property: IncludeNullValues - #2":filterQuantitativeIncludeNullValues();break;case"Filter Property: Period - #3":filterRelativeDatePeriod();break;case"Filter Property: Range - #3":filterRelativeDateRange();break;case"Filter Property: RangeN - #3":filterRelativeDateRangeN();break;case"Filter Property: AppliedFieldNames - #4":filterHierarchicalAppliedFieldNames()}}function renderViz(){var a=$("#mainViz"),b="https://"+serverName+"/t/SkunkWorks/views/JavaScriptTarget/Dashboard",c={hideTabs:!1,hideToolbar:!1,width:a.parent().innerWidth()+"px",height:a.parent().innerHeight()+"px",onFirstInteractive:function(){mainWorkbook=mainViz.getWorkbook()}};mainViz=new tableauSoftware.Viz(a[0],b,c)}function renderVizMoreOptions(){var a=$("#mainViz"),b="https://"+serverName+"/t/SkunkWorks/views/JavaScriptTarget/Dashboard",c={hideTabs:!1,hideToolbar:!1,width:a.parent().innerWidth()+"px",height:a.parent().innerHeight()+"px",Category:"Office Supplies,Furniture","Top Customers":22,onFirstInteractive:function(){mainWorkbook=mainViz.getWorkbook()}};mainViz=new tableauSoftware.Viz(a[0],b,c)}function dispose(){return null===mainViz?void alertOrConsole("No Viz has been rendered, so I can't dispose anything"):void mainViz.dispose()}function hideViz(){return null===mainViz||mainViz.getIsHidden()===!0?void alertOrConsole("No Viz has been rendered, or it's already hidden."):void mainViz.hide()}function showViz(){return null===mainViz||mainViz.getIsHidden()===!1?void alertOrConsole("No Viz has been rendered yet, or it's already visible."):void mainViz.show()}function getIsVizHidden(){alertOrConsole(mainViz.getIsHidden())}function showToolbar(){return null===mainViz||mainViz.getIsToolbarHidden()===!1?void alertOrConsole("No Viz has been rendered yet, or toolbar is already visible."):void mainViz.showToolbar()}function hideToolbar(){return null===mainViz||mainViz.getIsToolbarHidden()===!0?void alertOrConsole("No Viz has been rendered yet, or toolbar is already hidden."):void mainViz.hideToolbar()}function areToolbarsHidden(){alertOrConsole(mainViz.getIsToolbarHidden())}function showTabsPlease(){return null===mainViz||mainViz.getAreTabsHidden()===!1?void alertOrConsole("No Viz has been rendered yet, or tabs are already visible."):void mainViz.showTabs()}function hideTabsPlease(){return null===mainViz||mainViz.getAreTabsHidden()===!0?void alertOrConsole("No Viz has been rendered yet, or tabs are already hidden."):(mainViz.hideTabs(),void alertOrConsole("hideTabs"))}function areTabssHidden(){alertOrConsole(mainViz.getAreTabsHidden())}function showDownloadWorkbook(){mainViz.showDownloadWorkbookDialog()}function showExportCrosstabDialog(){mainViz.showExportCrossTabDialog("Profit by Subcategory")}function exportData(){mainViz.showExportDataDialog("Sales by Date")}function exportImage(){mainViz.showExportImageDialog()}function exportPDF(){mainViz.showExportPDFDialog()}function getAreAutomaticUpdatesPaused(){alertOrConsole(mainViz.getAreAutomaticUpdatesPaused())}function getParentElement(){alertOrConsole(mainViz.getParentElement())}function getURL(){alertOrConsole(mainViz.getUrl())}function getWorkbook(){alertOrConsole(mainViz.getWorkbook().getName())}function pauseAutomaticUpdatesAsync(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.pauseAutomaticUpdatesAsync()}function refreshData(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.refreshDataAsync()}function resumeAutomaticUpdates(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.resumeAutomaticUpdatesAsync()}function revertAll(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.revertAllAsync()}function setFrameSize(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.setFrameSize(900,480)}function showShareDialog(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.showShareDialog()}function toggleAutomaticUpdates(){return null===mainViz?void alertOrConsole("No Viz has been rendered"):void mainViz.toggleAutomaticUpdatesAsync()}function activateEventListeners(){alert("Activating event listeners. Try: selecting marks, creating / loading / deleting custom views, changing filters, changing parameters, switching tabs. When you're tried of pop-ups, Deactivate event listeners"),mainViz.addEventListener("marksselection",onMarksSelection),mainViz.addEventListener("parametervaluechange",onParameterChanged),mainViz.addEventListener("filterchange",onFilterChanged),mainViz.addEventListener("customviewload",onCustomViewLoaded),mainViz.addEventListener("customviewsave",onCustomViewUpdated),mainViz.addEventListener("customviewremove",onCustomViewRemoved),mainViz.addEventListener("customviewsetdefault",onCustomViewSetDefault),mainViz.addEventListener("tabswitch",onTabSwitch),mainViz.addEventListener("STORYPOINTSWITCH",onStoryPointSwitch)}function alertOrConsole(a){console.log(a)}function onMarksSelection(){alertOrConsole("onMarksSelection event")}function onParameterChanged(){alertOrConsole("onParameterChanged event")}function onFilterChanged(){alertOrConsole("onFilterChanged event")}function onCustomViewLoaded(){alertOrConsole("onCustomViewLoaded event")}function onCustomViewUpdated(){alertOrConsole("onCustomViewUpdated event")}function onCustomViewRemoved(){alertOrConsole("onCustomViewRemoved event")}function onCustomViewSetDefault(){alertOrConsole("onCustomViewSetDefault event")}function onTabSwitch(){alertOrConsole("onTabSwitch event")}function onStoryPointSwitch(a){alertOrConsole("Moved from StoryPoint '"+a.getOldStoryPointInfo().getCaption()+"' to '"+a.getNewStoryPoint().getCaption()+"'")}function deactivateEventListeners(){mainViz.removeEventListener("marksselection",onMarksSelection),mainViz.removeEventListener("parametervaluechange",onParameterChanged),mainViz.removeEventListener("filterchange",onFilterChanged),mainViz.removeEventListener("customviewload",onCustomViewLoaded),mainViz.removeEventListener("customviewsave",onCustomViewUpdated),mainViz.removeEventListener("customviewremove",onCustomViewRemoved),mainViz.removeEventListener("customviewsetdefault",onCustomViewSetDefault),mainViz.removeEventListener("tabswitch",onTabSwitch),mainViz.removeEventListener("STORYPOINTSWITCH",onStoryPointSwitch),alert("Listeners deactivated")}function changeParameterValueAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.changeParameterValueAsync("Top Customers",10).then(function(){alertOrConsole("'Top Customers' parameter set to 10")})}function revertAllAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.revertAllAsync()}function rememberCustomViewAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.rememberCustomViewAsync("Test")}function removeCustomViewAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.removeCustomViewAsync("Test")}function showCustomViewAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.showCustomViewAsync("Test")}function setActiveCustomViewAsDefaultAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.setActiveCustomViewAsDefaultAsync()}function getActiveCustomView(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveCustomView();alertOrConsole(null===a?"A *Custom View* is not currently active. Switch to one, then try again":"Sheet : "+a.getName()+"\nOwner: "+a.getOwnerName()+"\nCustom URL: "+a.getUrl())}function getActiveSheet(){var a=mainViz.getWorkbook().getActiveSheet().getName();alertOrConsole("Sheet : "+a)}function getName(){mainWorkbook=mainViz.getWorkbook(),alertOrConsole("Workbook Name : "+mainWorkbook.getName())}function getParametersAsync(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("This workbook contains "+a.length+" parameters")},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function getPublishedSheetsInfo(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getPublishedSheetsInfo(),b=[];$.each(a,function(a,c){b.push(c.getName())}),alertOrConsole("Worksheet & Dashboard count: "+a.length+"\nNames: "+b.join(", "))}function customView(){mainWorkbook=mainViz.getWorkbook();var a=function(a){newCustomView=a},b=function(){alertOrConsole("Whoops")};mainWorkbook.rememberCustomViewAsync("Test2").then(a,b)}function saveAsync(){newCustomView.saveAsync().then(function(){alertOrConsole("The URL for this new view is :"+newCustomView.getUrl())})}function setAdvertised(){newCustomView.setAdvertised(!0),newCustomView.saveAsync()}function setName(){newCustomView.setName("Renamed Test 2"),newCustomView.saveAsync()}function showAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.showCustomViewAsync("Test2")}function activateSheetRange(){mainWorkbook=mainViz.getWorkbook().activateSheetAsync("Sales by Date")}function activateSheetCategorical(){mainWorkbook=mainViz.getWorkbook().activateSheetAsync("Profit by Subcategory")}function activateSheetDatePeriod(){mainWorkbook=mainViz.getWorkbook().activateSheetAsync("Shipped by Date")}function activateSheetRelative(){mainWorkbook=mainViz.getWorkbook().activateSheetAsync("Profit by Date")}function applyHierarchicalFilterAsync(){alertOrConsole("Sorry, this workbook isn't cube-connected, so I'm not implemented")}function applyFilterAsync(){mainWorkbook=mainViz.getWorkbook();var a=function(a){a.applyFilterAsync("Category","Technology","REPLACE")},b=function(a){alertOrConsole(a)};mainWorkbook.activateSheetAsync("Profit by Subcategory").then(a,b)}function applyFilterMoreAsync(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet(),b=function(){a.applyFilterAsync("Category","Technology","REMOVE")},c=function(a){alertOrConsole(a)};a.applyFilterAsync("Category",["Furniture","Office Supplies"],"ADD").then(b,c)}function applyAll(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet();a.applyFilterAsync("Category","","ALL")}function applyRangeFilterAsync(){mainWorkbook=mainViz.getWorkbook();{var a=function(a){var b=new Date("October 15, 2010"),c=new Date("December 1, 2011"),d={min:b,max:c};a.applyRangeFilterAsync("Order Date",d)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Sales by Date").then(a,b)}}function applyRelativeDateFilterAsync(){mainWorkbook=mainViz.getWorkbook();{var a=function(a){a.applyRelativeDateFilterAsync("Ship Date",{anchorDate:new Date("12/1/2012"),periodType:tableauSoftware.PeriodType.DAY,rangeType:tableauSoftware.DateRangeType.LASTN,rangeN:376})},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(a,b)}}function clearHierarchicalFilter(){alertOrConsole("Not implemented")}function clearCategorical(){mainWorkbook=mainViz.getWorkbook();var a=function(a){a.clearFilterAsync("Category")},b=function(a){alertOrConsole(a)};mainWorkbook.activateSheetAsync("Profit by Subcategory").then(a,b)}function clearRangeFilter(){var a=function(a){a.clearFilterAsync("Order Date")},b=function(a){alertOrConsole(a)};mainWorkbook.activateSheetAsync("Sales by Date").then(a,b)}function clearRelativeDateFilter(){var a=function(a){a.clearFilterAsync("Ship Date")},b=function(a){alertOrConsole(a)};mainWorkbook.activateSheetAsync("Shipped by Date").then(a,b)}function selectMarksInsideDashboard(){mainWorkbook=mainViz.getWorkbook();var a=mainViz.getWorkbook().getActiveSheet().getWorksheets().get("Profit v Sales");a.selectMarksAsync("Category","Technology","REPLACE")}function selectMarksAsync(){var a=function(a){a.selectMarksAsync("Category","Technology","REPLACE")},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Profit v Sales").then(a,b)}function selectMoreMarksAsync(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet();a.selectMarksAsync("Category","Office Supplies","ADD")}function selectMarksTwoDimensionsAsync(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet();a.clearSelectedMarksAsync().then(function(){var b=[new tableauSoftware.Mark([new tableauSoftware.Pair("Category",["Technology"]),new tableauSoftware.Pair("Customer",["Emily Phan","Deborah Brumfield"])])];a.selectMarksAsync(b,tableauSoftware.FilterUpdateType.ADD)})}function clearMarksAsync(){var a=mainWorkbook.getActiveSheet();a.clearSelectedMarksAsync()}function changeSizeAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Dashboard").then(function(a){var b={behavior:tableauSoftware.SheetSizeBehavior.EXACTLY,minSize:{width:250,height:150},maxSize:{width:250,height:150}};a.changeSizeAsync(b)})}function getDataSourcesAsync(){var a=function(a){alertOrConsole("The datasource for this worksheet is named "+a[0].getName())},b=function(){alertOrConsole("Whoops.")};mainViz.getWorkbook().activateSheetAsync("Sales by Date").then(function(){mainViz.getWorkbook().getActiveSheet().getDataSourcesAsync().then(a,b)})}function getFiltersAsync(){var a=mainWorkbook.getPublishedSheets()[0],b=function(a){alertOrConsole("This worksheet has "+a.length+" filter(s) associated with it.")},c=function(){alertOrConsole("Whoops")};a.activateAsync().then(function(){a.getFiltersAsync().then(b,c)})}function sheet_getIndex(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("The zero-based position of the 'Profit by Subcategory' sheet in the workbook is "+a.getIndex())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Profit by Subcategory").then(a,b)}function sheet_getIsActive(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("Is the worksheet 'Sales by Date' inside the Dashboard currently active?:  "+a.getWorksheets().get("Sales by Date").getIsActive())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Dashboard").then(a,b)}function sheet_getIsHidden(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="",a=mainWorkbook.getActiveSheet(),c=a.getWorksheets();for(i=0;i<c.length;i++)b=b+"Sheet '"+c[i].getName()+"': isHidden = "+c[i].getIsHidden()+"\n\r";alertOrConsole(b)};mainWorkbook.activateSheetAsync("Dashboard").then(a,onError)}function sheet_getName(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet();alertOrConsole("The index of the current active worksheet is "+a.getIndex()+".\nThe name of the sheet is "+a.getName())}function sheet_getObjects(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Dashboard").then(function(a){var b=a.getObjects();alertOrConsole("The worksheet named 'Dashboard' contains "+b.length+" objects")})}function getParentDashboard(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("The parent dashboard of 'Sales by Date' inside the Dashboard currently active?:  "+a.getWorksheets().get("Sales by Date").getParentDashboard().getName())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Dashboard").then(a,b)}function onSuccess(a){var b=a,c="";0===b.length?alertOrConsole("selectedMarks: empty list"):$.each(b,function(a,b){c+="selectedMarks:\n",$.each(b.getPairs(),function(a,b){c=c+"  "+b.fieldName+": "+b.value}),c+="\n"}),alertOrConsole(c)}function onError(a){alertOrConsole("Error: '"+a+"'")}function getSelectedMarksAsync(){mainWorkbook=mainViz.getWorkbook();var a=mainWorkbook.getActiveSheet();a.getSelectedMarksAsync().then(onSuccess,onError)}function getSheetType(){mainWorkbook=mainViz.getWorkbook(),alertOrConsole(mainWorkbook.getActiveSheet().getName()+"'s type is "+mainWorkbook.getActiveSheet().getSheetType())}function getSize(){mainWorkbook=mainViz.getWorkbook();var a,b=mainWorkbook.getActiveSheet(),c=b.getSize(),d=c.behavior,e=c.maxSize||"NA",f=c.minSize||"NA";a="Size behavior: "+d+"\n","NA"!=e?a=a+"maxSize - Height: "+e.height+", Width: "+e.width+"\n":a+="maxSize - Height: NA, Width: NA\n","NA"!=f?a=a+"minSize - Height: "+f.height+", Width: "+f.width+"\n":a+="minSize - Height: NA, Width: NA\n",alertOrConsole(a)}function sheet_getWorkbook(){mainWorkbook=mainViz.getWorkbook(),alertOrConsole("This sheet belongs to the "+mainWorkbook.getActiveSheet().getWorkbook().getName()+" workbook.")}function getDataSources(){var a=(mainWorkbook.getPublishedSheetsInfo(),function(a){dataSources=a,alertOrConsole("Complete. Now try fetching fields")}),b=function(){alertOrConsole("Whoops")};mainWorkbook=mainViz.getWorkbook();var c=mainWorkbook.getActiveSheet();c.getSheetType()==tableauSoftware.SheetType.DASHBOARD?alertOrConsole("Choose a sheet of type WORKSHEET, not of type DASHBOARD"):c.getDataSourcesAsync().then(a,b)}function getFields(){var a=dataSources[0].getFields(),b="";$.each(a,function(a,c){b=b+c.getName()+": "+c.getRole()+", "+c.getAggregation()+"\n"}),alertOrConsole(b)}function getIsPrimary(){alertOrConsole(dataSources[0].getIsPrimary())}function dataSourceGetName(){alertOrConsole(dataSources[0].getName())}function getObjects(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Dashboard").then(function(a){var b=a.getObjects(),c="";$.each(b,function(a,b){c+=b.getObjectType(),"WORKSHEET"==b.getObjectType()&&(c=c+": "+b.getWorksheet().getName()),c=c+"- xpos: "+b.getPosition().x+" ypos: "+b.getPosition().y+"\n"}),alertOrConsole(c)})}function getWorksheets(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(" There are "+a.getWorksheets().length+" worksheets in this dashboard")},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Dashboard").then(a,b)}function setActiveSheetDashboard(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(" There are "+a.getWorksheets().length+" worksheets in this dashboard")},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Dashboard").then(a,b)}function changeStorySizeAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){var b={behavior:tableauSoftware.SheetSizeBehavior.EXACTLY,minSize:{width:250,height:150},maxSize:{width:250,height:150}};a.changeSizeAsync(b)})}function activateStoryPointAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){a.activateStoryPointAsync(1)})}function activateNextStoryPointAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){a.activateNextStoryPointAsync()})}function activatePreviousStoryPointAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){a.activatePreviousStoryPointAsync()})}function revertStoryPointAsync(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){storyPoint=a.getActiveStoryPoint(),a.revertStoryPointAsync(a.getActiveStoryPoint().getIndex())})}function story_getName(){mainWorkbook=mainViz.getWorkbook(),mainWorkbook.activateSheetAsync("Story").then(function(a){alertOrConsole("The name of this story is '"+a.getName()+"'")})}function story_getIndex(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("The zero-based position of the 'Story' sheet in the workbook is "+a.getIndex())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Story").then(a,b)}function story_getIsActive(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("Is the Story 'Story' currently active?:  "+a.getIsActive())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Story").then(a,b)}function story_getIsHidden(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="",a=mainWorkbook.getActiveSheet();b=b+"Sheet '"+a.getName()+"': isHidden = "+a.getIsHidden(),alertOrConsole(b)};mainWorkbook.activateSheetAsync("Story").then(a,onError)}function story_getType(){mainWorkbook=mainViz.getWorkbook(),alertOrConsole(mainWorkbook.getActiveSheet().getName()+"'s type is "+mainWorkbook.getActiveSheet().getSheetType())}function story_getWorkbook(){mainWorkbook=mainViz.getWorkbook(),alertOrConsole(mainWorkbook.getActiveSheet().getName()+"'s parent workbook is "+mainWorkbook.getName())}function getStoryPointsInfo(){mainWorkbook=mainViz.getWorkbook(),storypoints=mainWorkbook.getActiveSheet().getStoryPointsInfo(),alertOrConsole(storypoints.length+" StoryPoints retreived from this Story.")}function getActiveStoryPoint(){alertOrConsole("StoryPoint "+mainWorkbook.getActiveSheet().getActiveStoryPoint().getIndex()+" (zero-based) is active in this Story.")}function storyPoint_getIndexAndCaption(){mainWorkbook.activateSheetAsync("Story").then(function(){alertOrConsole("StoryPoint '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getCaption()+"' is currently active in this Story, and is at index "+mainWorkbook.getActiveSheet().getActiveStoryPoint().getIndex())})}function storyPoint_getIsActive(){alertOrConsole("Is StoryPoint '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getCaption()+"' currently active in this Story?: "+mainWorkbook.getActiveSheet().getActiveStoryPoint().getIsActive())}function storyPoint_getIsUpdated(){alertOrConsole("isUpdated Property for StoryPoint '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getCaption()+"' is: "+mainWorkbook.getActiveSheet().getActiveStoryPoint().getIsUpdated())}function storyPoint_getContainedSheet(){alertOrConsole("The sheet contained by StoryPoint '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getCaption()+"' is '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getContainedSheet().getName()+"'")}function storyPoint_getParentStory(){alertOrConsole("The Story which contains StoryPoint '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getCaption()+"' is named '"+mainWorkbook.getActiveSheet().getActiveStoryPoint().getParentStory().getName()+"'")}function storyPointInfo_getIndexAndCaption(){mainWorkbook.activateSheetAsync("Story").then(function(a){storyPoints=a.getStoryPointsInfo();var b="";$.each(storyPoints,function(a,c){b=b+"Storypoint '"+c.getCaption()+"' in Story '"+c.getParentStory().getName(),b=b+" is index "+c.getIndex()+".\n\r"}),alertOrConsole(b)})}function storyPointInfo_getIsActive(){storyPoints=mainWorkbook.getActiveSheet().getStoryPointsInfo();var a="";$.each(storyPoints,function(b,c){a=a+"Storypoint '"+c.getCaption(),a+=c.getIsActive()===!0?"' IS ACTIVE \r\n":"' is inactive \r\n"}),alertOrConsole(a)}function storyPointInfo_getIsUpdated(){storyPoints=mainWorkbook.getActiveSheet().getStoryPointsInfo();var a="";$.each(storyPoints,function(b,c){a=a+"Storypoint '"+c.getCaption(),a+=c.getIsUpdated()===!0?"' has not been updated. \n\r":"' has been updated! \n\r"}),alertOrConsole(a)}function storyPointInfo_getParentStory(){storyPoints=mainWorkbook.getActiveSheet().getStoryPointsInfo();var a="";$.each(storyPoints,function(b,c){a=a+"The parent Story of StoryPoint '"+c.getCaption(),a=a+"' is '"+c.getParentStory().getName()+"'\n\r"}),alertOrConsole(a)}function parameters_getParametersAsync(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("This workbook contains "+a.length+" parameters")},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getCurrentValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n";var c=a.get("Top Customers").getCurrentValue();b=b+"\nCurrent Value: "+c.value,alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getDataType(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n",b=b+"\nData Type: "+a.get("Top Customers").getDataType(),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getAllowableValuesType(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n",b=b+"\nAllowable Values Type: "+a.get("Top Customers").getAllowableValuesType(),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getAllowableValues(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";
b=b+a.get("Cute Animals").getName()+"\n\n";var c=(a.get("Top Customers"),[]);$.each(a.get("Cute Animals").getAllowableValues(),function(a,b){var d=b.value;c.push(d)}),b=b+"Allowable Values: "+c.join(", "),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getMinMaxValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n",b=b+"\nminValue: "+a.get("Top Customers").getMinValue().value,b=b+"\nmaxValue: "+a.get("Top Customers").getMaxValue().value,alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getStepSize(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n",b=b+"\nStepSize: "+a.get("Top Customers").getStepSize(),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parameters_getDateStepPeriod(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Dates Dates Dates").getName()+"\n\n",b=b+"\nStep Period: "+a.get("Dates Dates Dates").getDateStepPeriod(),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parametersDate(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Dates Dates Dates").getName()+"\n\n",b=b+"Date Type: "+a.get("Dates Dates Dates").getDataType(),b=b+"\nStep Period: "+a.get("Dates Dates Dates").getDateStepPeriod(),b=b+"\nStep Size: "+a.get("Dates Dates Dates").getStepSize(),b=b+"\nAllowable Value Type: "+a.get("Dates Dates Dates").getAllowableValuesType(),b=b+"\nMin & Max Values, Current Value: "+a.get("Dates Dates Dates").getMinValue().formattedValue+", "+a.get("Dates Dates Dates").getMaxValue().formattedValue+", "+a.get("Dates Dates Dates").getCurrentValue().formattedDate;a.get("Dates Dates Dates").getAllowableValues();alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parametersString(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Cute Animals").getName()+"\n\n",b=b+"Date Type: "+a.get("Cute Animals").getDataType(),b=b+"\nAllowable Value Type: "+a.get("Cute Animals").getAllowableValuesType(),b=b+"\nCurrent Value: "+a.get("Cute Animals").getCurrentValue().value;var c=[];$.each(a.get("Cute Animals").getAllowableValues(),function(a,b){var d=b.value;c.push(d)}),b=b+"\nAllowable Values: "+c.join(", "),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function parametersNumeric(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="Name: ";b=b+a.get("Top Customers").getName()+"\n\n",b=b+"Date Type: "+a.get("Top Customers").getDataType(),b=b+"\nAllowable Value Type: "+a.get("Top Customers").getAllowableValuesType(),b=b+"\nCurrent Value: "+a.get("Top Customers").getCurrentValue().formattedValue;a.get("Top Customers");b=b+"\nStep Size, Min & Max Values: "+a.get("Top Customers").getStepSize()+", "+a.get("Top Customers").getMinValue().value+"-"+a.get("Top Customers").getMaxValue().value,alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.getParametersAsync().then(a,b)}function getFiltersAsyncAgain(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole("This worksheet has "+a.length+" filter(s) associated with it.")},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterCategoricalAppliedValues(){mainWorkbook=mainViz.getWorkbook();var a=function(a){var b="",c=[];$.each(a[0].getAppliedValues(),function(a,b){var d=b.value;c.push(d)}),b=b+"Applied Values: "+c.join(", "),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterCategoricalField(){var a=function(a){var b="Field Name: "+a.getName();b=b+"\nAggregation: "+a.getAggregation(),b=b+"\nData Source: "+a.getDataSource().getName(),b=b+"\nRole: "+a.getRole(),alertOrConsole(b)},b=function(){alertOrConsole("Whoops")},c=function(c){c[0].getFieldAsync().then(a,b)},d=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(a){a.getFiltersAsync().then(c,d)})}function filterCategoricalFieldName(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[0].getFieldName())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterCategoricalFilterType(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[0].getFilterType())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterCategoricalIsExcludeMode(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[0].getIsExcludeMode())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterCategoricalWorksheet(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[0].getWorksheet().getName())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterQuantitativeDomainMinValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[1].getDomainMin().formattedValue)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterQuantitativeDomainMaxValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[1].getDomainMax().formattedValue)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterQuantitativeMinValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[1].getMin().formattedValue)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterQuantitativeMaxValue(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[1].getMax().formattedValue)},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterQuantitativeIncludeNullValues(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[1].getIncludeNullValues())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterRelativeDatePeriod(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[2].getPeriod())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterRelativeDateRange(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[2].getRange())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterRelativeDateRangeN(){mainWorkbook=mainViz.getWorkbook();var a=function(a){alertOrConsole(a[2].getRangeN())},b=function(){alertOrConsole("Whoops")};mainWorkbook.activateSheetAsync("Shipped by Date").then(function(c){c.getFiltersAsync().then(a,b)})}function filterHierarchicalAppliedFieldNames(){alertOrConsole("Sorry, this filter type needs a cube behind it, and I don't have one for you.")}var pagesObj={reportsBaseUrl:"http://s1tsttabaps01/views/",sectionDescriptions:{Stats:"Graphs describing the medical register","UK maps":"Maps describing the medical register","World maps":"World maps describing the medical register"},repGroup:[{groupName:"The Register",description:"At the GMC we maintain the UK Medical Register. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"PRS1",description:"The Register Stats",pageHeading:"The Register",pageSubheading:"Key stats from the medical register",url:"TheRegister_pub/PRS1"},{pageId:"PRS1_H",description:"The Register over time",pageHeading:"The Register",pageSubheading:"The medical register over time",url:"TheRegister_pub/PRS1_H"},{pageId:"PRS2",description:"The Specialist Register",pageHeading:"The Specialist Register",pageSubheading:"Key stats from the Specialist Register",url:"TheRegister_pub/PRS2"},{pageId:"PRS2_H",description:"The Specialist Register over time",pageHeading:"The Specialist Register",pageSubheading:"The Specialist Register over time",url:"TheRegister_pub/PRS2_H"},{pageId:"PRS3",description:"Trainees",pageHeading:"Trainees",pageSubheading:"Doctors on the register who are known to be in training",url:"TheRegister_pub/PRS3"},{pageId:"PRS3_H",description:"Trainees over time",pageHeading:"Trainees",pageSubheading:"Trainees over time"},{pageId:"PRS4",description:"The GP Register",pageHeading:"The GP Register",pageSubheading:"Total number of GPs on the register over time",url:"TheRegister_pub/PRS4"}],"UK maps":[{pageId:"PRU1",description:"The Register UK Map",pageHeading:"The Register",pageSubheading:"Doctor population by UK country",url:"TheRegister_pub/PRU1"},{pageId:"PRU2",description:"The Register UK Map",pageHeading:"The Register",pageSubheading:"Doctor population by UK postcode",url:"TheRegister_pub/PRU2"}],"World maps":[{pageId:"PRW1",description:"The Register World Map",pageHeading:"The Register",pageSubheading:"Doctor population by country of qualification",url:"TheRegister_pub/PRW1"}]}},{groupName:"Revalidation",description:"At the GMC we maintain Revalidation. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"PVS2",description:"Connected Doctors",pageHeading:"Revalidation",pageSubheading:"Revalidation connections",url:"Revalidation_Pub/PVS1"}]}},{groupName:"Fitness to practise",description:"At the GMC we maintain the Fitness To Practise. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"PFS1",description:"FTP Stats",pageHeading:"Fitness to practise",pageSubheading:"Key volumes by year",url:"FitnesstoPractise_pub/PFS1"},{pageId:"PFS2",description:"Allegations",pageHeading:"Fitness to practise",pageSubheading:"Volumes of Allegations",url:"FitnesstoPractise_pub/PFS2"},{pageId:"PFS3",description:"Allegations mapped",pageHeading:"Fitness to practise",pageSubheading:"Volumes of Allegations",url:"FitnesstoPractise_pub/PFS3"},{pageId:"PFS4",description:"Complaints",pageHeading:"Complaints",pageSubheading:"Complaints received, and their overall Outcome",url:"FitnesstoPractise_pub/PFS4"},{pageId:"PFS5",description:"Sanctions",pageHeading:"Fitness to practise sanctions",pageSubheading:"FtP Sanctions imposed",url:"FitnesstoPractise_pub/PFS5"}],"UK Maps":[{pageId:"PFU1",description:"FTP UK Map",pageHeading:"Ftp Sanctions mapped",pageSubheading:"Current Designated Body of doctors with sanctions",url:"FitnesstoPractise_pub/PFU1"},{pageId:"PFU2",description:"FTP UK Map",pageHeading:"FtP Sanctions mapped",pageSubheading:"Current Designated Body of doctors with sanctions (relative to DB size)",url:"FitnesstoPractise_pub/PFU2"},{pageId:"PFU3",description:"FTP UK Map",pageHeading:"FtP Sanctions mapped",pageSubheading:"Medical School of doctors with sanctions",url:"FitnesstoPractise_pub/PFU3"}],"World Maps":[{pageId:"PFW1",description:"FTP World Map",pageHeading:"FtP Sanctions mapped",pageSubheading:"Country of primary medical qualifiation of doctors with sanctions",url:"FitnesstoPractise_pub/PFW1"},{pageId:"PFW2",description:"FTP World Map Active sanctions",pageHeading:"FtP Sanctions mapped",pageSubheading:"Country of PMQ of doctors with current sanctions - relative to PMQ population",url:"FitnesstoPractise_pub/PFW2"}]}},{groupName:"Employers",description:"At the GMC we maintain Employers. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"PES1",description:"Employers Stats (The Register)",pageHeading:"Employers overview",pageSubheading:"Key stats from the register, by organisation (Drs' Designated Bodies)",url:"Employers_pub/PES1"},{pageId:"PES10",description:"Employer Stats (FtP)",pageHeading:"Employers overview",pageSubheading:"Key FtP Stats by organisation (Drs' Designated Bodies)",url:"Employers_pub/PES10"},{pageId:"PES21",description:"Employer Stats (Reval)",pageHeading:"Employers overview",pageSubheading:"Key Revalidation stats by Designated Body",url:"Employers_pub/PES21"},{pageId:"PES34",description:"Employer Summary (The Register)",pageHeading:"Employer summary",pageSubheading:"Stats from the medical register",url:"Employers_pub/PES34"},{pageId:"PES35",description:"Employer Summary (FtP)",pageHeading:"Employer summary",pageSubheading:"Fitness to Practise information",url:"Employers_pub/PES35"}],"UK maps":[{pageId:"PEU1",description:"Employers UK Map",pageHeading:"Employers mapped",pageSubheading:"Doctor's employers (Designated Bodies), by location",url:"Employers_pub/PEU1"}]}},{groupName:"Medical Schools",description:"At the GMC we maintain Medical Schools. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"X__PMS1",description:"Medical Schools stats",pageHeading:"-",pageSubheading:""}],"UK maps":[{pageId:"X__PMU1",description:"Medical Schools UK Map",pageHeading:"-",pageSubheading:"-"}],"World maps":[{pageId:"X__PMW1",description:"Medical Schools World Map",pageHeading:"-",pageSubheading:"-"}]}},{groupName:"Royal Colleges",description:"At the GMC we maintain Royal Colleges. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"X_PCS1",description:"Royal Colleges/Specialities Stats",pageHeading:"-",pageSubheading:"-"}],"UK maps":[{pageId:"X_PCU1",description:"Royal Colleges/Specialities UK Map"}]}},{groupName:"Deaneries",description:"At the GMC we maintain Deaneries. Here we describe lots of stuff<br/>And here is another introduction sentence",pages:{Stats:[{pageId:"X__PDS1",description:"Deaneries Stats",pageHeading:"-",pageSubheading:"-"}]}}]},agora=window.agora||{};!function(){agora.reports={dataSrc:pagesObj,getGroups:function(){var a=[];return $.each(this.dataSrc.repGroup,function(b,c){a.push(c.groupName)}),a},getPages:function(a){var b=this.sanitizeCategoryName(a),c=$.grep(this.dataSrc.repGroup,function(a){return a.groupName==b});return"undefined"==typeof c[0]?!1:c[0].pages},getSectionDescription:function(a){var b=this.sanitizeCategoryName(a),c=$.grep(this.dataSrc.repGroup,function(a){return a.groupName==b});return"undefined"==typeof c[0]?!1:c[0].description},sanitizeCategoryName:function(a){var b=a.replace("_"," ");return b},getSectionDescriptions:function(a,b){var c=[];return $.each(b,function(b,d){var e=a.sectionDescriptions[d];c[d]=e}),c},search:function(a){var b=[];return $.each(a,function(a,c){b.push(c)}),b},getReportStructure:function(){var a={},b=this.getGroups();return $.each(b,function(b,c){var d=agora.reports.getPages(c);a[c]=d}),a}},groups=agora.reports.getReportStructure()}(),function(){function a(a){if(a.__basePrototypePending){var b=a.__baseType;b.__basePrototypePending&&b.__setupBase();for(var c in b.prototype){var d=b.prototype[c];a.prototype[c]||(a.prototype[c]=d)}delete a.__basePrototypePending,delete a.__setupBase}}function b(a,b,c){a.__basePrototypePending&&a.__setupBase(),c?a.__baseType.apply(b,c):a.__baseType.apply(b)}function c(a,b,c,d){var e=a.__baseType.prototype[c];return d?e.apply(b,d):e.apply(b)}function d(){for(var a in g)if(g.hasOwnProperty(a)){var b=g[a],c=b.isPrototype?f.prototype:f;b.func?c[a]=b.func:delete c[a]}}var e={version:"0.7.4.0",isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isNullOrUndefined:function(a){return null===a||void 0===a},isValue:function(a){return null!==a&&void 0!==a}},f=Function,g={registerNamespace:{isPrototype:!1,func:f.registerNamespace},registerInterface:{isPrototype:!0,func:f.prototype.registerInterface},registerClass:{isPrototype:!0,func:f.prototype.registerClass},registerEnum:{isPrototype:!0,func:f.prototype.registerEnum}},h={};f.registerNamespace=function(a){"tableauSoftware"===a&&(window.tableauSoftware=window.tableauSoftware||{})},f.prototype.registerInterface=function(){},f.prototype.registerEnum=function(){for(var a in this.prototype)this[a]=this.prototype[a]},f.prototype.registerClass=function(d,e){var f=this;this.prototype.constructor=this,this.__baseType=e||Object,e&&(this.__basePrototypePending=!0,this.__setupBase=function(){a(f)},this.initializeBase=function(a,c){b(f,a,c)},this.callBaseMethod=function(a,b,d){c(f,a,b,d)})},e.Delegate=function(){},e.Delegate.registerClass("Delegate"),e.Delegate.empty=function(){},e.Delegate._contains=function(a,b,c){for(var d=0;d<a.length;d+=2)if(a[d]===b&&a[d+1]===c)return!0;return!1},e.Delegate._create=function(a){var b=function(){if(2==a.length)return a[1].apply(a[0],arguments);for(var b=a.concat(),c=0;c<b.length;c+=2)e.Delegate._contains(a,b[c],b[c+1])&&b[c+1].apply(b[c],arguments);return null};return b._targets=a,b},e.Delegate.create=function(a,b){return a?e.Delegate._create([a,b]):b},e.Delegate.combine=function(a,b){if(!a)return b._targets?b:e.Delegate.create(null,b);if(!b)return a._targets?a:e.Delegate.create(null,a);var c=a._targets?a._targets:[null,a],d=b._targets?b._targets:[null,b];return e.Delegate._create(c.concat(d))},e.Delegate.remove=function(a,b){if(!a||a===b)return null;if(!b)return a;var c,d=a._targets,f=null;b._targets?(f=b._targets[0],c=b._targets[1]):c=b;for(var g=0;g<d.length;g+=2)if(d[g]===f&&d[g+1]===c)return 2==d.length?null:(d.splice(g,2),e.Delegate._create(d));return a},e.IEnumerator=function(){},e.IEnumerator.prototype={get_current:null,moveNext:null,reset:null},e.IEnumerator.getEnumerator=function(a){return a?a.getEnumerator?a.getEnumerator():new e.ArrayEnumerator(a):null},e.IEnumerable=function(){},e.IEnumerable.prototype={getEnumerator:null},e.ArrayEnumerator=function(a){this._array=a,this._index=-1,this.current=null},e.ArrayEnumerator.prototype={moveNext:function(){return this._index++,this.current=this._array[this._index],this._index<this._array.length},reset:function(){this._index=-1,this.current=null}},e.IDisposable=function(){},e.IDisposable.prototype={dispose:null},e.StringBuilder=function(a){this._parts=e.isNullOrUndefined(a)?[]:[a],this.isEmpty=0==this._parts.length},e.StringBuilder.prototype={append:function(a){return e.isNullOrUndefined(a)||(this._parts.push(a),this.isEmpty=!1),this},appendLine:function(a){return this.append(a),this.append("\r\n"),this.isEmpty=!1,this},clear:function(){this._parts=[],this.isEmpty=!0},toString:function(a){return this._parts.join(a||"")}},e.StringBuilder.registerClass("StringBuilder"),e.EventArgs=function(){},e.EventArgs.registerClass("EventArgs"),e.EventArgs.Empty=new e.EventArgs,e.CancelEventArgs=function(){e.CancelEventArgs.initializeBase(this),this.cancel=!1},e.CancelEventArgs.registerClass("CancelEventArgs",e.EventArgs),e.Tuple=function(a,b,c){this.first=a,this.second=b,3==arguments.length&&(this.third=c)},e.Tuple.registerClass("Tuple"),f.registerNamespace("tab"),h.EscapingUtil=function(){},h.EscapingUtil.escapeHtml=function(a){var b=a||"";return b=b.replace(new RegExp("&","g"),"&amp;"),b=b.replace(new RegExp("<","g"),"&lt;"),b=b.replace(new RegExp(">","g"),"&gt;"),b=b.replace(new RegExp('"',"g"),"&quot;"),b=b.replace(new RegExp("'","g"),"&#39;"),b=b.replace(new RegExp("/","g"),"&#47;")},h.WindowHelper=function(a){this.$6=a},h.WindowHelper.close=function(a){a.close()},h.WindowHelper.getOpener=function(a){return a.opener},h.WindowHelper.getLocation=function(a){return a.location},h.WindowHelper.setLocationHref=function(a,b){a.location.href=b},h.WindowHelper.locationReplace=function(a,b){a.location.replace(b)},h.WindowHelper.clearLocationHash=function(a){var b=a.href;return b=b.substr(0,b.length-a.hash.length),"#"===b.charAt(b.length-1)&&(b=b.substr(0,b.length-1)),b},h.WindowHelper.updateURLRetryInfo=function(a,b,c){var d=a.search,e=d.indexOf(":retry=true");if(c)-1===e&&(d.length?b=b.replace(d,d+"&:retry=true"):b+="?:retry=true");else if(-1!==e){var f="";"?:retry=true"!==d&&(f=d.replace("&:retry=true","")),b=b.replace(d,f)}return b},h.WindowHelper.open=function(a,b){window.open(a,b)},h.WindowHelper.reload=function(a,b){a.location.reload(b)},h.WindowHelper.requestAnimationFrame=function(a){return h.WindowHelper.$4(a)},h.WindowHelper.cancelAnimationFrame=function(a){e.isValue(a)&&h.WindowHelper.$5(a)},h.WindowHelper.reloadLocation=function(a){var b=h.WindowHelper.clearLocationHash(window.location);b=h.WindowHelper.updateURLRetryInfo(window.location,b,a),window.location.replace(b)},h.WindowHelper.locationIndicatesRetry=function(){return-1!==window.location.search.indexOf(":retry=true")},h.WindowHelper.$7=function(){var a=0;h.WindowHelper.$4=function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a));a=c+d;var e=window.setTimeout(function(){b()},d);return e}},h.WindowHelper.prototype={$6:null,get_pageXOffset:function(){return h.WindowHelper.$2(this.$6)},get_pageYOffset:function(){return h.WindowHelper.$3(this.$6)},get_innerWidth:function(){return h.WindowHelper.$0(this.$6)},get_innerHeight:function(){return h.WindowHelper.$1(this.$6)}},h.EscapingUtil.registerClass("tab.EscapingUtil"),h.WindowHelper.registerClass("tab.WindowHelper"),h.WindowHelper.retryString=":retry=true",h.WindowHelper.$0=null,h.WindowHelper.$1=null,h.WindowHelper.$2=null,h.WindowHelper.$3=null,h.WindowHelper.$4=null,h.WindowHelper.$5=null,function(){h.WindowHelper.$0="innerWidth"in window?function(a){return a.innerWidth}:function(a){return a.document.documentElement.offsetWidth},h.WindowHelper.$1="innerHeight"in window?function(a){return a.innerHeight}:function(a){return a.document.documentElement.offsetHeight},h.WindowHelper.$2=e.isValue(window.self.pageXOffset)?function(a){return a.pageXOffset}:function(a){return a.document.documentElement.scrollLeft},h.WindowHelper.$3=e.isValue(window.self.pageYOffset)?function(a){return a.pageYOffset}:function(a){return a.document.documentElement.scrollTop};var a="requestAnimationFrame",b="cancelAnimationFrame",c=["ms","moz","webkit","o"],d=null,f=null;a in window&&(d=a),b in window&&(f=b);for(var g=0;g<c.length&&(null==d||null==f);++g){var i=c[g],j=i+"RequestAnimationFrame";null==d&&j in window&&(d=j),null==f&&(j=i+"CancelAnimationFrame",j in window&&(f=j),j=i+"CancelRequestAnimationFrame",j in window&&(f=j))}null!=d?h.WindowHelper.$4=function(a){return window[d](a)}:h.WindowHelper.$7(),h.WindowHelper.$5=null!=f?function(a){window[f](a)}:function(a){window.clearTimeout(a)}}(),f.registerNamespace("tab"),h.$create__SheetInfoImpl=function(a,b,c,d,e,f,g,h,i){var j={};return j.name=a,j.sheetType=b,j.index=c,j.size=d,j.workbook=e,j.url=f,j.isActive=g,j.isHidden=h,j.zoneId=i,j},h.$create_JavaScriptApi$2=function(a,b,c,d,e){var f={};return f.$1=a,f.$0=b,f.$2=c,f.$3=d,f.$4=e,f},h.$create__StoryPointInfoImpl=function(a,b,c,d,e,f){var g={};return g.caption=a,g.index=b,g.storyPointId=c,g.isActive=d,g.isUpdated=e,g.parentStoryImpl=f,g},h._ApiCommand=function(a,b,c,d){this.$0=a,this.$2=b,this.$1=c,this.$3=d},h._ApiCommand.parse=function(a){var b,c=a.indexOf(",");if(0>c)return b=a,new h._ApiCommand(b,null,null,null);b=a.substr(0,c);var d,e=a.substr(c+1);if(c=e.indexOf(","),0>c)return d=e,new h._ApiCommand(b,d,null,null);d=e.substr(0,c);var f,g=e.substr(c+1);if(c=g.indexOf(","),0>c)return f=g,new h._ApiCommand(b,d,f,null);f=g.substr(0,c);var i=g.substr(c+1);return new h._ApiCommand(b,d,f,i)},h._ApiCommand.prototype={$0:null,$1:null,$2:null,$3:null,get_name:function(){return this.$0},get_handlerId:function(){return this.$1},get_sourceId:function(){return this.$2},get_parameters:function(){return this.$3},get_isApiCommandName:function(){return!this.get_rawName().indexOf("api.",0)},get_rawName:function(){return this.$0},serialize:function(){var a=[];a.push(this.$0),a.push(this.$2),a.push(this.$1),e.isValue(this.$3)&&a.push(this.$3);var b=a.join(",");return b}},h._ApiServerResultParser=function(a){var b=JSON.parse(a);this.$0=b["api.commandResult"],this.$1=b["api.commandData"]},h._ApiServerResultParser.prototype={$0:null,$1:null,get_result:function(){return this.$0},get_data:function(){return this.$1}},h.JavaScriptApi$4=function(a){var b=JSON.parse(a);this.$0=b["api.workbookName"],this.$1=b["api.worksheetName"],this.$2=b["api.commandData"]},h.JavaScriptApi$4.prototype={$0:null,$1:null,$2:null,get_$3:function(){return this.$0},get_$4:function(){return this.$1},get_$5:function(){return this.$2}},h._CommandReturnHandler=function(a,b,c,d){this.$0=a,this.$2=c,this.$1=b,this.$3=d},h._CommandReturnHandler.prototype={$0:null,$1:0,$2:null,$3:null,get_commandName:function(){return this.$0},get_successCallback:function(){return this.$2},get_successCallbackTiming:function(){return this.$1},get_errorCallback:function(){return this.$3}},h.JavaScriptApi$1=function(){this.$2={},this.$3={},this.$4={},this.$5={},h._Utility.hasWindowAddEventListener()?window.addEventListener("message",this.$8(),!1):h._Utility.hasDocumentAttachEvent()?(document.attachEvent("onmessage",this.$8()),window.attachEvent("onmessage",this.$8())):window.onmessage=this.$8(),this.$0=this.$1=0},h.JavaScriptApi$1.prototype={$0:0,$1:0,registerHandler:function(a){var b="handler"+this.$0;if(e.isValue(a.get_handlerId())||e.isValue(this.$2[a.get_handlerId()]))throw h._TableauException.createInternalError("Handler '"+a.get_handlerId()+"' is already registered.");this.$0++,a.set_handlerId(b),this.$2[b]=a,a.add_customViewsListLoad(e.Delegate.create(this,this.$6)),a.add_stateReadyForQuery(e.Delegate.create(this,this.$7))},unregisterHandler:function(a){(e.isValue(a.get_handlerId())||e.isValue(this.$2[a.get_handlerId()]))&&(delete this.$2[a.get_handlerId()],a.remove_customViewsListLoad(e.Delegate.create(this,this.$6)),a.remove_stateReadyForQuery(e.Delegate.create(this,this.$7)))},sendCommand:function(a,b,c){var d=a.get_iframe(),f=a.get_handlerId();if(h._Utility.hasWindowPostMessage()&&!e.isNullOrUndefined(d)&&!e.isNullOrUndefined(d.contentWindow)){var g="cmd"+this.$1;this.$1++;var i=this.$3[f];e.isNullOrUndefined(i)&&(i={},this.$3[f]=i),i[g]=c;var j=c.get_commandName();if("api.ShowCustomViewCommand"===j){var k=this.$4[f];e.isNullOrUndefined(k)&&(k={},this.$4[f]=k),k[g]=c}var l=null;e.isValue(b)&&(l=h.JsonUtil.toJson(b,!1,""));var m=new h._ApiCommand(j,g,f,l),n=m.serialize();h._Utility.isPostMessageSynchronous()?window.setTimeout(function(){d.contentWindow.postMessage(n,a.get_serverRoot())},0):d.contentWindow.postMessage(n,a.get_serverRoot())}},$6:function(a){var b=a.get_handlerId(),c=this.$4[b];if(!e.isNullOrUndefined(c)){var d=c;for(var f in d){var g={key:f,value:d[f]},h=g.value;e.isValue(h.get_successCallback())&&h.get_successCallback()(null)}delete this.$4[b]}},$7:function(a){var b=this.$5[a.get_handlerId()];if(!h._Utility.isNullOrEmpty(b))for(;b.length>0;){var c=b.pop();e.isValue(c)&&c()}},$8:function(){return e.Delegate.create(this,function(a){this.$9(a)})},$9:function(a){if(!e.isNullOrUndefined(a.data)){var b=h._ApiCommand.parse(a.data),c=b.get_rawName(),d=b.get_handlerId(),f=this.$2[d];(e.isNullOrUndefined(f)||f.get_handlerId()!==b.get_handlerId())&&(f=new h.JavaScriptApi$0),b.get_isApiCommandName()?"xdomainSourceId"===b.get_sourceId()?f.handleEventNotification(b.get_name(),b.get_parameters()):this.$A(b):this.$B(c,a,f)}},$A:function(a){var b=this.$3[a.get_handlerId()],c=e.isValue(b)?b[a.get_sourceId()]:null;if(!e.isNullOrUndefined(c)&&(delete b[a.get_sourceId()],a.get_name()===c.get_commandName())){var d=new h._ApiServerResultParser(a.get_parameters()),f=d.get_data();if("api.success"===d.get_result())switch(c.get_successCallbackTiming()){case 0:e.isValue(c.get_successCallback())&&c.get_successCallback()(f);break;case 1:var g=function(){e.isValue(c.get_successCallback())&&c.get_successCallback()(f)},i=this.$5[a.get_handlerId()];e.isNullOrUndefined(i)&&(i=[],this.$5[a.get_handlerId()]=i),i.push(g);break;default:throw h._TableauException.createInternalError("Unknown timing value: "+c.get_successCallbackTiming())}else if(e.isValue(c.get_errorCallback())){var j="api.remotefailed"===d.get_result();c.get_errorCallback()(j,f)}}},$B:function(a,b,c){if("tableau.loadIndicatorsLoaded"===a){var d=this.$2;for(var e in d){var f={key:e,value:d[e]};if(h._Utility.hasOwnProperty(this.$2,f.key)&&f.value.get_iframe().contentWindow===b.source){f.value.hideLoadIndicators();break}}}else"layoutInfoReq"===a?this.$C(b.source):("tableau.completed"===a||"completed"===a||"layoutInfoReq"===a)&&c.handleVizLoad()},$C:function(a){if(h._Utility.hasWindowPostMessage()){var b=new h.WindowHelper(window.self),c=e.isValue(b.get_innerWidth())?b.get_innerWidth():document.documentElement.offsetWidth,d=e.isValue(b.get_innerHeight())?b.get_innerHeight():document.documentElement.offsetHeight,f=e.isValue(b.get_pageXOffset())?b.get_pageXOffset():document.documentElement.scrollLeft,g=e.isValue(b.get_pageYOffset())?b.get_pageYOffset():document.documentElement.scrollTop,i=[];i.push("layoutInfoResp"),i.push(f),i.push(g),i.push(c),i.push(d),a.postMessage(i.join(","),"*")}}},h.JavaScriptApi$0=function(){},h.JavaScriptApi$0.prototype={$0:null,add_customViewsListLoad:function(a){this.$1=e.Delegate.combine(this.$1,a)},remove_customViewsListLoad:function(a){this.$1=e.Delegate.remove(this.$1,a)},$1:null,add_stateReadyForQuery:function(a){this.$2=e.Delegate.combine(this.$2,a)},remove_stateReadyForQuery:function(a){this.$2=e.Delegate.remove(this.$2,a)},$2:null,get_iframe:function(){return null},get_handlerId:function(){return this.$0},set_handlerId:function(a){return this.$0=a,a},get_serverRoot:function(){return"*"},hideLoadIndicators:function(){},handleVizLoad:function(){},handleEventNotification:function(){},$3:function(){this.$1(null),this.$2(null)}},h.CrossDomainMessagingOptions=function(a,b){h._Param.verifyValue(a,"router"),h._Param.verifyValue(b,"handler"),this.$0=a,this.$1=b},h.CrossDomainMessagingOptions.prototype={$0:null,$1:null,get_router:function(){return this.$0},get_handler:function(){return this.$1},sendCommand:function(a,b){this.$0.sendCommand(this.$1,a,b)}},h._Enums=function(){},h._Enums.$0=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.PeriodType,!0)},h._Enums.$1=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.DateRangeType,!0)},h._Enums.$2=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.FilterUpdateType,!0)},h._Enums.$3=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.SelectionUpdateType,!0)},h._Enums.$4=function(a){var b=e.isValue(a)?a.toString():"";return null!=h._Enums.$8(b,"",tableauSoftware.SelectionUpdateType,!1)},h._Enums.$5=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.NullOption,!0)},h._Enums.$6=function(a,b){var c=e.isValue(a)?a:"";return h._Enums.$8(c,b,tableauSoftware.SheetSizeBehavior,!0)},h._Enums.$7=function(a){var b=e.isValue(a)?a:"";return h._Enums.$8(b,"",tableauSoftware.TableauEventName,!1)},h._Enums.$8=function(a,b,c,d){if(e.isValue(a)){var f=a.toString().toUpperCase(),g=c;for(var i in g){var j={key:i,value:g[i]},k=j.value.toString().toUpperCase();if(f===k)return j.value}}if(d)throw h._TableauException.createInvalidParameter(b);return null},h._ApiBootstrap=function(){},h._ApiBootstrap.initialize=function(){h._ApiObjectRegistry.registerCrossDomainMessageRouter(function(){return new h.JavaScriptApi$1})},h._ApiObjectRegistry=function(){},h._ApiObjectRegistry.registerCrossDomainMessageRouter=function(a){return h._ApiObjectRegistry.$3("ICrossDomainMessageRouter",a)
},h._ApiObjectRegistry.getCrossDomainMessageRouter=function(){return h._ApiObjectRegistry.$5("ICrossDomainMessageRouter")},h._ApiObjectRegistry.disposeCrossDomainMessageRouter=function(){h._ApiObjectRegistry.$6("ICrossDomainMessageRouter")},h._ApiObjectRegistry.$3=function(a,b){e.isNullOrUndefined(h._ApiObjectRegistry.$1)&&(h._ApiObjectRegistry.$1={});var c=h._ApiObjectRegistry.$1[a];return h._ApiObjectRegistry.$1[a]=b,c},h._ApiObjectRegistry.$4=function(a){if(e.isNullOrUndefined(h._ApiObjectRegistry.$1))throw h._TableauException.createInternalError("No types registered");var b=h._ApiObjectRegistry.$1[a];if(e.isNullOrUndefined(b))throw h._TableauException.createInternalError("No creation function has been registered for interface type '"+a+"'.");var c=b();return c},h._ApiObjectRegistry.$5=function(a){e.isNullOrUndefined(h._ApiObjectRegistry.$2)&&(h._ApiObjectRegistry.$2={});var b=h._ApiObjectRegistry.$2[a];return e.isNullOrUndefined(b)&&(b=h._ApiObjectRegistry.$4(a),h._ApiObjectRegistry.$2[a]=b),b},h._ApiObjectRegistry.$6=function(a){if(e.isNullOrUndefined(h._ApiObjectRegistry.$2))return null;var b=h._ApiObjectRegistry.$2[a];return delete h._ApiObjectRegistry.$2[a],b},h._CustomViewImpl=function(a,b,c){this.$2=a,this.$4=b,this.$3=c,this.$7=!1,this.$8=!1,this.$9=!1},h._CustomViewImpl._getAsync=function(a){var b=new h._Deferred;return b.resolve(a.get__customViewImpl().get_$A()),b.get_promise()},h._CustomViewImpl._createNew=function(a,b,c,d){var e=new h._CustomViewImpl(a,c.name,b);e.$7=c.isPublic,e.$6=c._sessionUrl;var f=c.owner;return e.$5=f.friendlyName,e.$8=!1,null!=d&&d===c.id&&(e.$8=!0),e.$1=c,e},h._CustomViewImpl._saveNewAsync=function(a,b,c){var d=new h._Deferred,f={};f["api.customViewName"]=c;var g=h._CustomViewImpl.$13("api.SaveNewCustomViewCommand",d,function(c){h._CustomViewImpl._processCustomViewUpdate(a,b,c,!0);var f=null;e.isValue(a.get_$19())&&(f=a.get_$19().get_item(0)),d.resolve(f)});return b.sendCommand(f,g),d.get_promise()},h._CustomViewImpl._showCustomViewAsync=function(a,b,c){var d=new h._Deferred,f={};e.isValue(c)&&(f["api.customViewParam"]=c);var g=h._CustomViewImpl.$13("api.ShowCustomViewCommand",d,function(){var b=a.get_activeCustomView();d.resolve(b)});return b.sendCommand(f,g),d.get_promise()},h._CustomViewImpl._makeCurrentCustomViewDefaultAsync=function(a,b){var c=new h._Deferred,d={},e=h._CustomViewImpl.$13("api.MakeCurrentCustomViewDefaultCommand",c,function(){var b=a.get_activeCustomView();c.resolve(b)});return b.sendCommand(d,e),c.get_promise()},h._CustomViewImpl._getCustomViewsAsync=function(a,b){var c=new h._Deferred,d=new h._CommandReturnHandler("api.FetchCustomViewsCommand",0,function(d){var e=d;h._CustomViewImpl._processCustomViews(a,b,e),c.resolve(a.get_$18()._toApiCollection())},function(a,b){c.reject(h._TableauException.create("serverError",b))});return b.sendCommand(null,d),c.get_promise()},h._CustomViewImpl._processCustomViews=function(a,b,c){h._CustomViewImpl._processCustomViewUpdate(a,b,c,!1)},h._CustomViewImpl._processCustomViewUpdate=function(a,b,c,d){d&&a.set_$19(new h._Collection),a.set_$1B(null);var f=null;if(e.isValue(c.currentView)){var g=c.currentView;f=g.name}var i=null;if(e.isValue(c.defaultId)&&(i=c.defaultId),d&&e.isValue(c.newView)){var j=h._CustomViewImpl._createNew(a,b,c.newView,i);a.get_$19()._add(j.get_$D(),j.get_$A())}if(a.set_$1A(a.get_$18()),a.set_$18(new h._Collection),e.isValue(c.list)){var k=c.list;if(k.length>0)for(var l=0;l<k.length;l++){var m=h._CustomViewImpl._createNew(a,b,k[l],i);a.get_$18()._add(m.get_$D(),m.get_$A()),a.get_$1A()._has(m.get_$D())?a.get_$1A()._remove(m.get_$D()):d&&(a.get_$19()._has(m.get_$D())||a.get_$19()._add(m.get_$D(),m.get_$A())),e.isValue(f)&&m.get_$D()===f&&a.set_$1B(m.get_$A())}}},h._CustomViewImpl.$13=function(a,b,c){var d=function(a,c){b.reject(h._TableauException.create("serverError",c))};return new h._CommandReturnHandler(a,0,c,d)},h._CustomViewImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:!1,$8:!1,$9:!1,get_$A:function(){return null==this.$0&&(this.$0=new tableauSoftware.CustomView(this)),this.$0},get_$B:function(){return this.$2.get_workbook()},get_$C:function(){return this.$6},get_$D:function(){return this.$4},set_$D:function(a){if(this.$9)throw h._TableauException.create("staleDataReference","Stale data");return this.$4=a,a},get_$E:function(){return this.$5},get_$F:function(){return this.$7},set_$F:function(a){if(this.$9)throw h._TableauException.create("staleDataReference","Stale data");return this.$7=a,a},get_$10:function(){return this.$8},$11:function(){if(this.$9||e.isNullOrUndefined(this.$1))throw h._TableauException.create("staleDataReference","Stale data");this.$1.isPublic=this.$7,this.$1.isDefault=this.$8,this.$1.name=this.$4;var a=new h._Deferred,b={};b["api.customViewParam"]=this.$1;var c=h._CustomViewImpl.$13("api.UpdateCustomViewCommand",a,e.Delegate.create(this,function(b){h._CustomViewImpl._processCustomViewUpdate(this.$2,this.$3,b,!0),a.resolve(this.get_$A())}));return this.$3.sendCommand(b,c),a.get_promise()},$12:function(){var a=new h._Deferred,b={};b["api.customViewParam"]=this.$1;var c=h._CustomViewImpl.$13("api.RemoveCustomViewCommand",a,e.Delegate.create(this,function(b){this.$9=!0;var c=b;h._CustomViewImpl._processCustomViews(this.$2,this.$3,c),a.resolve(this.get_$A())}));return this.$3.sendCommand(b,c),a.get_promise()},_showAsync:function(){if(this.$9||e.isNullOrUndefined(this.$1))throw h._TableauException.create("staleDataReference","Stale data");return h._CustomViewImpl._showCustomViewAsync(this.$2,this.$3,this.$1)},$14:function(a){return this.$5!==a.$5||this.$6!==a.$6||this.$7!==a.$7||this.$8!==a.$8}},h._DashboardImpl=function(a,b,c){this.$F=new h._Collection,this.$10=new h._Collection,h._DashboardImpl.initializeBase(this,[a,b,c])},h._DashboardImpl.prototype={$E:null,get_sheet:function(){return this.get_dashboard()},get_dashboard:function(){return null==this.$E&&(this.$E=new tableauSoftware.Dashboard(this)),this.$E},get_worksheets:function(){return this.$F},get_objects:function(){return this.$10},$11:function(a,b){this.$10=new h._Collection,this.$F=new h._Collection;for(var c=0;c<a.length;c++){var d=a[c],f=null;if("worksheet"===a[c].$0){var g=d.$1;if(e.isNullOrUndefined(g))continue;var i=this.$F.get__length(),j=h.SheetSizeFactory.createAutomatic(),k=!1,l=b(g),m=e.isNullOrUndefined(l),n=m?"":l.getUrl(),o=h.$create__SheetInfoImpl(g,"worksheet",i,j,this.get_workbook(),n,k,m,d.$4),p=new h._WorksheetImpl(o,this.get_workbookImpl(),this.get_messagingOptions(),this);f=p.get_worksheet(),this.$F._add(g,p.get_worksheet())}var q=new tableauSoftware.DashboardObject(d,this.get_dashboard(),f);this.$10._add(c.toString(),q)}}},h.JavaScriptApi$3=function(a,b){this.$2=new h._Collection,this.$1=a,this.$3=b},h.JavaScriptApi$3.$9=function(a){return e.isValue(a)&&e.isValue(h.JavaScriptApi$3.$0[a])?h.JavaScriptApi$3.$0[a]:"NONE"},h.JavaScriptApi$3.$B=function(a,b){for(var c=a.worksheetDataSchemaMap[b].primaryDatasource,d=a.parametersDatasource,f=new h._Collection,g=null,i=a.dataSourceList,j=0;j<i.length;j++){var k=i[j];if(k.datasource!==d){var l=k.datasource===c,m=new h.JavaScriptApi$3(k.datasource,l);l?g=m:f._add(k.datasource,m.get_$5());for(var n=0;n<k.fieldList.length;n++){var o,p,q=k.fieldList[n];if(!e.isValue(q.baseColumnName))if(e.isValue(q.columnList))for(var r=q.columnList,s=0,t=r.length;t>s;s++){var u=r[s];o=h.JavaScriptApi$3.$C(u.fieldRole),p=h.JavaScriptApi$3.$9(u.aggregation);var v=new tableauSoftware.Field(m.get_$5(),u.name,o,p);m.$A(v)}else{o=h.JavaScriptApi$3.$C(q.defaultFieldRole),p=h.JavaScriptApi$3.$9(q.defaultAggregation);var w=new tableauSoftware.Field(m.get_$5(),q.name,o,p);m.$A(w)}}}}return e.isValue(g)&&f._addToFirst(g.get_$6(),g.get_$5()),f},h.JavaScriptApi$3.$C=function(a){if(e.isValue(a)){if("dimension"===a)return"dimension";if("measure"===a)return"measure"}return"unknown"},h.JavaScriptApi$3.prototype={$1:null,$3:!1,$4:null,get_$5:function(){return null==this.$4&&(this.$4=new tableauSoftware.DataSource(this)),this.$4},get_$6:function(){return this.$1},get_$7:function(){return this.$2},get_$8:function(){return this.$3},$A:function(a){this.$2._add(a.getName(),a)}},h._DeferredUtil=function(){},h._DeferredUtil.$0=function(a){var b;if(a instanceof tableauSoftware.Promise)b=a;else if(e.isValue(a)&&"function"==typeof a.valueOf&&(a=a.valueOf()),h._DeferredUtil.$4(a)){var c=new h._DeferredImpl;a.then(e.Delegate.create(c,c.resolve),e.Delegate.create(c,c.reject)),b=c.get_promise()}else b=h._DeferredUtil.$2(a);return b},h._DeferredUtil.$1=function(a){return h._DeferredUtil.$0(a).then(function(a){return h._DeferredUtil.$3(a)},null)},h._DeferredUtil.$2=function(a){var b=new h._PromiseImpl(function(b){try{return h._DeferredUtil.$0(e.isValue(b)?b(a):a)}catch(c){return h._DeferredUtil.$3(c)}});return b},h._DeferredUtil.$3=function(a){var b=new h._PromiseImpl(function(b,c){try{return e.isValue(c)?h._DeferredUtil.$0(c(a)):h._DeferredUtil.$3(a)}catch(d){return h._DeferredUtil.$3(d)}});return b},h._DeferredUtil.$4=function(a){return e.isValue(a)&&"function"==typeof a.then},h._CollectionImpl=function(){this.$0=[],this.$1={}},h._CollectionImpl.prototype={get__length:function(){return this.$0.length},get__rawArray:function(){return this.$0},_get:function(a){var b=this.$4(a);return e.isValue(this.$1[b])?this.$1[b]:void 0},_has:function(a){return e.isValue(this._get(a))},_add:function(a,b){this.$3(a,b);var c=this.$4(a);this.$0.push(b),this.$1[c]=b},_addToFirst:function(a,b){this.$3(a,b);var c=this.$4(a);this.$0.unshift(b),this.$1[c]=b},_remove:function(a){var b=this.$4(a);if(e.isValue(this.$1[b])){var c=this.$1[b];delete this.$1[b];for(var d=0;d<this.$0.length;d++)if(this.$0[d]===c){this.$0.splice(d,1);break}}},_toApiCollection:function(){var a=this.$0.concat();return a.get=e.Delegate.create(this,function(a){return this._get(a)}),a.has=e.Delegate.create(this,function(a){return this._has(a)}),a},$2:function(a){if(h._Utility.isNullOrEmpty(a))throw new Error("Null key");if(this._has(a))throw new Error("Duplicate key '"+a+"'")},$3:function(a,b){if(this.$2(a),e.isNullOrUndefined(b))throw new Error("Null item")},$4:function(a){return"_"+a},get_item:function(a){return this.$0[a]}},h._DeferredImpl=function(){this.$2=[],this.$0=new h._PromiseImpl(e.Delegate.create(this,this.then)),this.$1=e.Delegate.create(this,this.$5),this.$3=e.Delegate.create(this,this.$6)},h._DeferredImpl.prototype={$0:null,$1:null,$3:null,get_promise:function(){return this.$0},$4:function(a){var b=new h._DeferredImpl,c=a.length,d=c,e=[];if(!c)return b.resolve(e),b.get_promise();for(var f=function(a,c){var f=h._DeferredUtil.$0(a);f.then(function(a){return e[c]=a,d--,d||b.resolve(e),null},function(a){return b.reject(a),null})},g=0;c>g;g++)f(a[g],g);return b.get_promise()},then:function(a,b){return this.$1(a,b)},resolve:function(a){return this.$3(a)},reject:function(a){return this.$3(h._DeferredUtil.$3(a))},$5:function(a,b){var c=new h._DeferredImpl;return this.$2.push(function(d){d.then(a,b).then(e.Delegate.create(c,c.resolve),e.Delegate.create(c,c.reject))}),c.get_promise()},$6:function(a){var b=h._DeferredUtil.$0(a);this.$1=b.then,this.$3=h._DeferredUtil.$0;for(var c=0;c<this.$2.length;c++){var d=this.$2[c];d(b)}return this.$2=null,b}},h._PromiseImpl=function(a){this.then=a},h._PromiseImpl.prototype={then:null,always:function(a){return this.then(a,a)},otherwise:function(a){return this.then(null,a)}},h._MarkImpl=function(a){if(this.$1=new h._Collection,h._jQueryShim.$12(a))for(var b=a,c=0;c<b.length;c++){var d=b[c];if(!e.isValue(d.fieldName))throw h._TableauException.createInvalidParameter("pair.fieldName");if(!e.isValue(d.value))throw h._TableauException.createInvalidParameter("pair.value");var f=new tableauSoftware.Pair(d.fieldName,d.value);this.$1._add(f.fieldName,f)}else this.$2=a},h._MarkImpl.$6=function(a){var b=new h._Collection;if(e.isNullOrUndefined(a)||h._Utility.isNullOrEmpty(a.marks))return b;for(var c=e.IEnumerator.getEnumerator(a.marks);c.moveNext();){var d=c.current,f=d.tupleId,g=new tableauSoftware.Mark(f);b._add(f.toString(),g);for(var i=e.IEnumerator.getEnumerator(d.pairs);i.moveNext();){var j=i.current,k=h._Utility.convertRawValue(j.value,j.valueDataType),l=new tableauSoftware.Pair(j.fieldName,k);l.formattedValue=j.formattedValue,g.$0.get_$3()._has(l.fieldName)||g.$0.$7(l)}}return b},h._MarkImpl.prototype={$0:null,$2:0,get_$3:function(){return this.$1},get_$4:function(){return this.$2},get_$5:function(){return null==this.$0&&(this.$0=this.$1._toApiCollection()),this.$0},$7:function(a){this.$1._add(a.fieldName,a)}},h._Param=function(){},h._Param.verifyString=function(a,b){if(e.isNullOrUndefined(a)||!a.length)throw h._TableauException.createInternalStringArgumentException(b)},h._Param.verifyValue=function(a,b){if(e.isNullOrUndefined(a))throw h._TableauException.createInternalNullArgumentException(b)},h._ParameterImpl=function(a){if(this.$1=a.name,this.$2=h._Utility.getDataValue(a.currentValue),this.$3=h._ParameterImpl.$16(a.dataType),this.$4=h._ParameterImpl.$14(a.allowableValuesType),e.isValue(a.allowableValues)&&"list"===this.$4){this.$5=[];for(var b=e.IEnumerator.getEnumerator(a.allowableValues);b.moveNext();){var c=b.current;this.$5.push(h._Utility.getDataValue(c))}}"range"===this.$4&&(this.$6=h._Utility.getDataValue(a.minValue),this.$7=h._Utility.getDataValue(a.maxValue),this.$8=a.stepSize,("date"===this.$3||"datetime"===this.$3)&&e.isValue(this.$8)&&e.isValue(a.dateStepPeriod)&&(this.$9=h._ParameterImpl.$15(a.dateStepPeriod)))},h._ParameterImpl.$14=function(a){switch(a){case"list":return"list";case"range":return"range";case"any":default:return"all"}},h._ParameterImpl.$15=function(a){switch(a){case"hour":return"hour";case"second":return"second";case"minute":return"minute";case"day":return"day";case"week":return"week";case"month":return"month";case"quarter":return"quarter";case"year":default:return"year"}},h._ParameterImpl.$16=function(a){if("boolean"===a)return"boolean";switch(a){case"real":return"float";case"integer":case"tuple":return"integer";case"date":return"date";case"datetime":return"datetime";case"cstring":default:return"string"}},h._ParameterImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,get_$A:function(){return null==this.$0&&(this.$0=new tableauSoftware.Parameter(this)),this.$0},get_$B:function(){return this.$1},get_$C:function(){return this.$2},get_$D:function(){return this.$3},get_$E:function(){return this.$4},get_$F:function(){return this.$5},get_$10:function(){return this.$6},get_$11:function(){return this.$7},get_$12:function(){return this.$8},get_$13:function(){return this.$9}},h._SheetImpl=function(a,b,c){h._Param.verifyValue(a,"sheetInfoImpl"),h._Param.verifyValue(b,"workbookImpl"),h._Param.verifyValue(c,"messagingOptions"),this.$0=a.name,this.$1=a.index,this.$2=a.isActive,this.$3=a.isHidden,this.$4=a.sheetType,this.$5=a.size,this.$6=a.url,this.$7=b,this.$8=c,this.$A=a.zoneId},h._SheetImpl.$B=function(a){return e.isValue(a)?h._Utility.toInt(a):a},h._SheetImpl.$C=function(a){var b=h._Enums.$6(a.behavior,"size.behavior"),c=a.minSize;e.isValue(c)&&(c=h.$create_Size(h._SheetImpl.$B(a.minSize.width),h._SheetImpl.$B(a.minSize.height)));var d=a.maxSize;return e.isValue(d)&&(d=h.$create_Size(h._SheetImpl.$B(a.maxSize.width),h._SheetImpl.$B(a.maxSize.height))),h.$create_SheetSize(b,c,d)},h._SheetImpl.prototype={$0:null,$1:0,$2:!1,$3:!1,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,$A:0,get_name:function(){return this.$0},get_index:function(){return this.$1},get_workbookImpl:function(){return this.$7},get_workbook:function(){return this.$7.get_workbook()},get_url:function(){if(this.$3)throw h._TableauException.createNoUrlForHiddenWorksheet();return this.$6},get_size:function(){return this.$5},get_isHidden:function(){return this.$3},get_isActive:function(){return this.$2},set_isActive:function(a){return this.$2=a,a},get_isDashboard:function(){return"dashboard"===this.$4},get_sheetType:function(){return this.$4},get_parentStoryPoint:function(){return e.isValue(this.$9)?this.$9.get_storyPoint():null},get_parentStoryPointImpl:function(){return this.$9},set_parentStoryPointImpl:function(a){if("story"===this.$4)throw h._TableauException.createInternalError("A story cannot be a child of another story.");return this.$9=a,a},get_zoneId:function(){return this.$A},get_messagingOptions:function(){return this.$8},changeSizeAsync:function(a){if(a=h._SheetImpl.$C(a),"worksheet"===this.$4&&"automatic"!==a.behavior)throw h._TableauException.createInvalidSizeBehaviorOnWorksheet();var b=new h._Deferred;if(this.$5.behavior===a.behavior&&"automatic"===a.behavior)return b.resolve(a),b.get_promise();var c=this.$D(a),d={};d["api.setSheetSizeName"]=this.$0,d["api.minWidth"]=c["api.minWidth"],d["api.minHeight"]=c["api.minHeight"],d["api.maxWidth"]=c["api.maxWidth"],d["api.maxHeight"]=c["api.maxHeight"];var f=new h._CommandReturnHandler("api.SetSheetSizeCommand",1,e.Delegate.create(this,function(){this.get_workbookImpl()._update(e.Delegate.create(this,function(){var a=this.get_workbookImpl().get_publishedSheets()._get(this.get_name()).getSize();b.resolve(a)}))}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(d,f),b.get_promise()},sendCommand:function(a,b){this.$8.sendCommand(a,b)},$D:function(a){var b=null;if(e.isNullOrUndefined(a)||e.isNullOrUndefined(a.behavior)||"automatic"!==a.behavior&&e.isNullOrUndefined(a.minSize)&&e.isNullOrUndefined(a.maxSize))throw h._TableauException.createInvalidSheetSizeParam();var c=0,d=0,f=0,g=0,i={};if(i["api.minWidth"]=0,i["api.minHeight"]=0,i["api.maxWidth"]=0,i["api.maxHeight"]=0,"automatic"===a.behavior)b=h.$create_SheetSize("automatic",void 0,void 0);else if("atmost"===a.behavior){if(e.isNullOrUndefined(a.maxSize)||e.isNullOrUndefined(a.maxSize.width)||e.isNullOrUndefined(a.maxSize.height))throw h._TableauException.createMissingMaxSize();if(a.maxSize.width<0||a.maxSize.height<0)throw h._TableauException.createInvalidSizeValue();i["api.maxWidth"]=a.maxSize.width,i["api.maxHeight"]=a.maxSize.height,b=h.$create_SheetSize("atmost",void 0,a.maxSize)}else if("atleast"===a.behavior){if(e.isNullOrUndefined(a.minSize)||e.isNullOrUndefined(a.minSize.width)||e.isNullOrUndefined(a.minSize.height))throw h._TableauException.createMissingMinSize();if(a.minSize.width<0||a.minSize.height<0)throw h._TableauException.createInvalidSizeValue();i["api.minWidth"]=a.minSize.width,i["api.minHeight"]=a.minSize.height,b=h.$create_SheetSize("atleast",a.minSize,void 0)}else if("range"===a.behavior){if(e.isNullOrUndefined(a.minSize)||e.isNullOrUndefined(a.maxSize)||e.isNullOrUndefined(a.minSize.width)||e.isNullOrUndefined(a.maxSize.width)||e.isNullOrUndefined(a.minSize.height)||e.isNullOrUndefined(a.maxSize.height))throw h._TableauException.createMissingMinMaxSize();if(a.minSize.width<0||a.minSize.height<0||a.maxSize.width<0||a.maxSize.height<0||a.minSize.width>a.maxSize.width||a.minSize.height>a.maxSize.height)throw h._TableauException.createInvalidRangeSize();i["api.minWidth"]=a.minSize.width,i["api.minHeight"]=a.minSize.height,i["api.maxWidth"]=a.maxSize.width,i["api.maxHeight"]=a.maxSize.height,b=h.$create_SheetSize("range",a.minSize,a.maxSize)}else if("exactly"===a.behavior){if(e.isValue(a.minSize)&&e.isValue(a.maxSize)&&e.isValue(a.minSize.width)&&e.isValue(a.maxSize.width)&&e.isValue(a.minSize.height)&&e.isValue(a.maxSize.height)){if(c=a.minSize.width,d=a.minSize.height,f=a.maxSize.width,g=a.maxSize.height,c!==f||d!==g)throw h._TableauException.createSizeConflictForExactly()}else e.isValue(a.minSize)&&e.isValue(a.minSize.width)&&e.isValue(a.minSize.height)?(c=a.minSize.width,d=a.minSize.height,f=c,g=d):e.isValue(a.maxSize)&&e.isValue(a.maxSize.width)&&e.isValue(a.maxSize.height)&&(f=a.maxSize.width,g=a.maxSize.height,c=f,d=g);i["api.minWidth"]=c,i["api.minHeight"]=d,i["api.maxWidth"]=f,i["api.maxHeight"]=g,b=h.$create_SheetSize("exactly",h.$create_Size(c,d),h.$create_Size(f,g))}return this.$5=b,i}},h._StoryImpl=function(a,b,c,d,e){h._StoryImpl.initializeBase(this,[a,b,c]),h._Param.verifyValue(d,"storyPm"),h._Param.verifyValue(e,"findSheetFunc"),this.$F=e,this.update(d)},h._StoryImpl.prototype={$E:null,$F:null,$10:null,$11:null,add_activeStoryPointChange:function(a){this.$12=e.Delegate.combine(this.$12,a)},remove_activeStoryPointChange:function(a){this.$12=e.Delegate.remove(this.$12,a)},$12:null,get_activeStoryPointImpl:function(){return this.$E},get_sheet:function(){return this.get_story()},get_story:function(){return null==this.$10&&(this.$10=new tableauSoftware.Story(this)),this.$10},get_storyPointsInfo:function(){return this.$11},update:function(a){var b=null,c=null;this.$11=this.$11||new Array(a.storyPoints.length);for(var d=0;d<a.storyPoints.length;d++){var f=a.storyPoints[d],g=f.caption,i=d===a.activeStoryPointIndex,j=h.$create__StoryPointInfoImpl(g,d,f.storyPointId,i,f.isUpdated,this);if(e.isNullOrUndefined(this.$11[d]))this.$11[d]=new tableauSoftware.StoryPointInfo(j);else if(this.$11[d]._impl.storyPointId===j.storyPointId){var k=this.$11[d]._impl;k.caption=j.caption,k.index=j.index,k.isActive=i,k.isUpdated=j.isUpdated}else this.$11[d]=new tableauSoftware.StoryPointInfo(j);i&&(b=f.containedSheetInfo,c=j)}var l=this.$11.length-a.storyPoints.length;this.$11.splice(a.storyPoints.length,l);var m=e.isNullOrUndefined(this.$E)||this.$E.get_storyPointId()!==c.storyPointId;e.isValue(this.$E)&&m&&this.$E.set_isActive(!1);var n=this.$E;if(m){var o=h._StoryPointImpl.createContainedSheet(b,this.get_workbookImpl(),this.get_messagingOptions(),this.$F);this.$E=new h._StoryPointImpl(c,o)}else this.$E.set_isActive(c.isActive),this.$E.set_isUpdated(c.isUpdated);m&&e.isValue(n)&&this.$16(this.$11[n.get_index()],this.$E.get_storyPoint())},activatePreviousStoryPointAsync:function(){return this.$13("api.ActivatePreviousStoryPoint")},activateNextStoryPointAsync:function(){return this.$13("api.ActivateNextStoryPoint")},activateStoryPointAsync:function(a){var b=new h._Deferred;if(0>a||a>=this.$11.length)throw h._TableauException.createIndexOutOfRange(a);var c=this.get_activeStoryPointImpl(),d={};d["api.storyPointIndex"]=a;var f=new h._CommandReturnHandler("api.ActivateStoryPoint",0,e.Delegate.create(this,function(a){var d=a;this.$15(c,d),b.resolve(this.$E.get_storyPoint())}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(d,f),b.get_promise()},revertStoryPointAsync:function(a){if(a=a||this.$E.get_index(),0>a||a>=this.$11.length)throw h._TableauException.createIndexOutOfRange(a);var b=new h._Deferred,c={};c["api.storyPointIndex"]=a;var d=new h._CommandReturnHandler("api.RevertStoryPoint",0,e.Delegate.create(this,function(c){var d=c;this.$14(a,d),b.resolve(this.$11[a])}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(c,d),b.get_promise()},$13:function(a){if("api.ActivatePreviousStoryPoint"!==a&&"api.ActivateNextStoryPoint"!==a)throw h._TableauException.createInternalError("commandName '"+a+"' is invalid.");var b=new h._Deferred,c=this.get_activeStoryPointImpl(),d={},f=new h._CommandReturnHandler(a,0,e.Delegate.create(this,function(a){var d=a;this.$15(c,d),b.resolve(this.$E.get_storyPoint())}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(d,f),b.get_promise()},$14:function(a,b){var c=this.$11[a]._impl;if(c.storyPointId!==b.storyPointId)throw h._TableauException.createInternalError("We should not be updating a story point where the IDs don't match. Existing storyPointID="+c.storyPointId+", newStoryPointID="+b.storyPointId);c.caption=b.caption,c.isUpdated=b.isUpdated,b.storyPointId===this.$E.get_storyPointId()&&this.$E.set_isUpdated(b.isUpdated)},$15:function(a,b){var c=b.index;if(a.get_index()!==c){var d=this.$11[a.get_index()],e=this.$11[c]._impl,f=h._StoryPointImpl.createContainedSheet(b.containedSheetInfo,this.get_workbookImpl(),this.get_messagingOptions(),this.$F);e.isActive=!0,this.$E=new h._StoryPointImpl(e,f),a.set_isActive(!1),d._impl.isActive=!1,this.$16(d,this.$E.get_storyPoint())}},$16:function(a,b){null!=this.$12&&this.$12(a,b)}},h._StoryPointImpl=function(a,b){if(this.$2=a.isActive,this.$3=a.isUpdated,this.$0=a.caption,this.$1=a.index,this.$5=a.parentStoryImpl,this.$7=a.storyPointId,this.$4=b,e.isValue(b)&&(this.$4.set_parentStoryPointImpl(this),"dashboard"===b.get_sheetType()))for(var c=this.$4,d=0;d<c.get_worksheets().get__length();d++){var f=c.get_worksheets().get_item(d);f._impl.set_parentStoryPointImpl(this)}},h._StoryPointImpl.createContainedSheet=function(a,b,c,d){var f=h._WorkbookImpl.$8(a.sheetType),g=-1,i=h.SheetSizeFactory.createAutomatic(),j=!1,k=d(a.name),l=e.isNullOrUndefined(k),m=l?"":k.getUrl(),n=h.$create__SheetInfoImpl(a.name,f,g,i,b.get_workbook(),m,j,l,a.zoneId);if("worksheet"===a.sheetType){var o=null,p=new h._WorksheetImpl(n,b,c,o);return p}if("dashboard"===a.sheetType){var q=new h._DashboardImpl(n,b,c),r=h._WorkbookImpl.$9(a.dashboardZones);return q.$11(r,d),q}throw h._TableauException.createInternalError("story"===a.sheetType?"Cannot have a story embedded within another story.":"Unknown sheet type '"+a.sheetType+"'")},h._StoryPointImpl.prototype={$0:null,$1:0,$2:!1,$3:!1,$4:null,$5:null,$6:null,$7:0,get_caption:function(){return this.$0},get_containedSheetImpl:function(){return this.$4},get_index:function(){return this.$1},get_isActive:function(){return this.$2},set_isActive:function(a){return this.$2=a,a},get_isUpdated:function(){return this.$3},set_isUpdated:function(a){return this.$3=a,a},get_parentStoryImpl:function(){return this.$5},get_storyPoint:function(){return null==this.$6&&(this.$6=new tableauSoftware.StoryPoint(this)),this.$6},get_storyPointId:function(){return this.$7},$8:function(){return h.$create__StoryPointInfoImpl(this.$0,this.$1,this.$7,this.$2,this.$3,this.$5)}},h.StoryPointInfoImplUtil=function(){},h.StoryPointInfoImplUtil.clone=function(a){return h.$create__StoryPointInfoImpl(a.caption,a.index,a.storyPointId,a.isActive,a.isUpdated,a.parentStoryImpl)},h._TableauException=function(){},h._TableauException.create=function(a,b){var c=new Error(b);return c.tableauSoftwareErrorCode=a,c},h._TableauException.createInternalError=function(a){return e.isValue(a)?h._TableauException.create("internalError","Internal error. Please contact Tableau support with the following information: "+a):h._TableauException.create("internalError","Internal error. Please contact Tableau support")},h._TableauException.createInternalNullArgumentException=function(a){return h._TableauException.createInternalError("Null/undefined argument '"+a+"'.")},h._TableauException.createInternalStringArgumentException=function(a){return h._TableauException.createInternalError("Invalid string argument '"+a+"'.")},h._TableauException.createServerError=function(a){return h._TableauException.create("serverError",a)},h._TableauException.createNotActiveSheet=function(){return h._TableauException.create("notActiveSheet","Operation not allowed on non-active sheet")},h._TableauException.createInvalidCustomViewName=function(a){return h._TableauException.create("invalidCustomViewName","Invalid custom view name: "+a)},h._TableauException.createInvalidParameter=function(a){return h._TableauException.create("invalidParameter","Invalid parameter: "+a)},h._TableauException.createInvalidFilterFieldNameOrValue=function(a){return h._TableauException.create("invalidFilterFieldNameOrValue","Invalid filter field name or value: "+a)},h._TableauException.createInvalidDateParameter=function(a){return h._TableauException.create("invalidDateParameter","Invalid date parameter: "+a)},h._TableauException.createNullOrEmptyParameter=function(a){return h._TableauException.create("nullOrEmptyParameter","Parameter cannot be null or empty: "+a)},h._TableauException.createMissingMaxSize=function(){return h._TableauException.create("missingMaxSize","Missing maxSize for SheetSizeBehavior.ATMOST")},h._TableauException.createMissingMinSize=function(){return h._TableauException.create("missingMinSize","Missing minSize for SheetSizeBehavior.ATLEAST")},h._TableauException.createMissingMinMaxSize=function(){return h._TableauException.create("missingMinMaxSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},h._TableauException.createInvalidRangeSize=function(){return h._TableauException.create("invalidSize","Missing minSize or maxSize for SheetSizeBehavior.RANGE")},h._TableauException.createInvalidSizeValue=function(){return h._TableauException.create("invalidSize","Size value cannot be less than zero")},h._TableauException.createInvalidSheetSizeParam=function(){return h._TableauException.create("invalidSize","Invalid sheet size parameter")},h._TableauException.createSizeConflictForExactly=function(){return h._TableauException.create("invalidSize","Conflicting size values for SheetSizeBehavior.EXACTLY")},h._TableauException.createInvalidSizeBehaviorOnWorksheet=function(){return h._TableauException.create("invalidSizeBehaviorOnWorksheet","Only SheetSizeBehavior.AUTOMATIC is allowed on Worksheets")},h._TableauException.createNoUrlForHiddenWorksheet=function(){return h._TableauException.create("noUrlForHiddenWorksheet","Hidden worksheets do not have a URL.")},h._TableauException.$0=function(a){return h._TableauException.create("invalidAggregationFieldName","Invalid aggregation type for field '"+a+"'")},h._TableauException.createIndexOutOfRange=function(a){return h._TableauException.create("indexOutOfRange","Index '"+a+"' is out of range.")},h._TableauException.createUnsupportedEventName=function(a){return h._TableauException.create("unsupportedEventName","Unsupported event '"+a+"'.")},h._TableauException.createBrowserNotCapable=function(){return h._TableauException.create("browserNotCapable","This browser is incapable of supporting the Tableau JavaScript API.")},h._Utility=function(){},h._Utility.hasOwnProperty=function(a,b){return a.hasOwnProperty(b)},h._Utility.isNullOrEmpty=function(a){return e.isNullOrUndefined(a)||(a.length||0)<=0},h._Utility.isString=function(a){return"string"==typeof a},h._Utility.isNumber=function(a){return"number"==typeof a},h._Utility.isDate=function(a){return"object"==typeof a&&a instanceof Date?!0:"[object Date]"!==Object.prototype.toString.call(a)?!1:!isNaN(a.getTime())},h._Utility.isDateValid=function(a){return!isNaN(a.getTime())},h._Utility.indexOf=function(a,b,c){if(e.isValue(Array.prototype.indexOf))return a.indexOf(b,c);c=c||0;var d=a.length;if(d>0)for(var f=c;d>f;f++)if(a[f]===b)return f;return-1},h._Utility.contains=function(a,b,c){var d=h._Utility.indexOf(a,b,c);return d>=0},h._Utility.getTopmostWindow=function(){for(var a=window.self;e.isValue(a.parent)&&a.parent!==a;)a=a.parent;return a},h._Utility.toInt=function(a){return h._Utility.isNumber(a)?a:parseInt(a.toString(),10)},h._Utility.toBoolean=function(a,b){var c=new RegExp("^(yes|y|true|t|1)$","i");if(h._Utility.isNullOrEmpty(a))return b;var d=a.match(c);return!h._Utility.isNullOrEmpty(d)},h._Utility.hasClass=function(a,b){var c=new RegExp("[\\n\\t\\r]","g");return e.isValue(a)&&(" "+a.className+" ").replace(c," ").indexOf(" "+b+" ")>-1},h._Utility.findParentWithClassName=function(a,b,c){var d=e.isValue(a)?a.parentNode:null;for(c=c||document.body;null!=d;){if(h._Utility.hasClass(d,b))return d;d=d===c?null:d.parentNode}return d},h._Utility.hasJsonParse=function(){return e.isValue(window.JSON)&&e.isValue(window.JSON.parse)},h._Utility.hasWindowPostMessage=function(){return e.isValue(window.postMessage)},h._Utility.isPostMessageSynchronous=function(){if(h._Utility.isIE()){var a=new RegExp("(msie) ([\\w.]+)"),b=a.exec(window.navigator.userAgent.toLowerCase()),c=b[2]||"0",d=parseInt(c,10);return 8>=d}return!1},h._Utility.hasDocumentAttachEvent=function(){return e.isValue(document.attachEvent)},h._Utility.hasWindowAddEventListener=function(){return e.isValue(window.addEventListener)},h._Utility.isElementOfTag=function(a,b){return e.isValue(a)&&1===a.nodeType&&a.tagName.toLowerCase()===b.toLowerCase()},h._Utility.elementToString=function(a){var b=new e.StringBuilder;
if(b.append(a.tagName.toLowerCase()),h._Utility.isNullOrEmpty(a.id)||b.append("#").append(a.id),!h._Utility.isNullOrEmpty(a.className)){var c=a.className.split(" ");b.append(".").append(c.join("."))}return b.toString()},h._Utility.tableauGCS=function(a){return e.isValue(window.getComputedStyle)?window.getComputedStyle(a):a.currentStyle},h._Utility.isIE=function(){return window.navigator.userAgent.indexOf("MSIE")>-1&&e.isNullOrUndefined(window.opera)},h._Utility.isSafari=function(){var a=window.navigator.userAgent,b=a.indexOf("WebKit")>=0,c=a.indexOf("Chrome")>=0;return a.indexOf("Safari")>=0||b&&!c},h._Utility.mobileDetect=function(){var a=window.navigator.userAgent;return-1!==a.indexOf("iPad")?!0:-1!==a.indexOf("Android")?!0:-1!==a.indexOf("AppleWebKit")&&-1!==a.indexOf("Mobile")?!0:!1},h._Utility.elementPosition=function(a){for(var b=0,c=0;!e.isNullOrUndefined(a);)c+=a.offsetTop,b+=a.offsetLeft,a=a.offsetParent;return h.$create_Point(b,c)},h._Utility.convertRawValue=function(a,b){if("boolean"===b)return a;if(e.isNullOrUndefined(a))return null;switch(b){case"date":case"datetime":return new Date(a);case"integer":case"real":return null==a?Number.NaN:a;case"cstring":case"tuple":case"unknown":default:return a}},h._Utility.getDataValue=function(a){return e.isNullOrUndefined(a)?h.$create_DataValue(null,null,null):h.$create_DataValue(h._Utility.convertRawValue(a.value,a.type),a.formattedValue,a.aliasedValue)},h._Utility.serializeDateForServer=function(a){var b="";if(e.isValue(a)&&h._Utility.isDate(a)){var c=a.getUTCFullYear(),d=a.getUTCMonth()+1,f=a.getUTCDate(),g=a.getUTCHours(),i=a.getUTCMinutes(),j=a.getUTCSeconds();b=c+"-"+d+"-"+f+" "+g+":"+i+":"+j}return b},h.VizImpl=function(a,b,c,d,f){if(!h._Utility.hasWindowPostMessage()||!h._Utility.hasJsonParse())throw h._TableauException.createBrowserNotCapable();this.$C=new h.CrossDomainMessagingOptions(a,this),this.$1=b,(e.isNullOrUndefined(c)||1!==c.nodeType)&&(c=document.body),this.$3=new h._VizParameters(c,d,f),this.$4=this.$3.get_url(),e.isValue(f)&&(this.$8=f.onFirstInteractive)},h.VizImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:!1,$A:!1,$B:!1,$C:null,add_customViewsListLoad:function(a){this.$D=e.Delegate.combine(this.$D,a)},remove_customViewsListLoad:function(a){this.$D=e.Delegate.remove(this.$D,a)},$D:null,add_stateReadyForQuery:function(a){this.$E=e.Delegate.combine(this.$E,a)},remove_stateReadyForQuery:function(a){this.$E=e.Delegate.remove(this.$E,a)},$E:null,add_$F:function(a){this.$10=e.Delegate.combine(this.$10,a)},remove_$F:function(a){this.$10=e.Delegate.remove(this.$10,a)},$10:null,add_$11:function(a){this.$12=e.Delegate.combine(this.$12,a)},remove_$11:function(a){this.$12=e.Delegate.remove(this.$12,a)},$12:null,add_$13:function(a){this.$14=e.Delegate.combine(this.$14,a)},remove_$13:function(a){this.$14=e.Delegate.remove(this.$14,a)},$14:null,add_$15:function(a){this.$16=e.Delegate.combine(this.$16,a)},remove_$15:function(a){this.$16=e.Delegate.remove(this.$16,a)},$16:null,add_$17:function(a){this.$18=e.Delegate.combine(this.$18,a)},remove_$17:function(a){this.$18=e.Delegate.remove(this.$18,a)},$18:null,add_$19:function(a){this.$1A=e.Delegate.combine(this.$1A,a)},remove_$19:function(a){this.$1A=e.Delegate.remove(this.$1A,a)},$1A:null,add_$1B:function(a){this.$1C=e.Delegate.combine(this.$1C,a)},remove_$1B:function(a){this.$1C=e.Delegate.remove(this.$1C,a)},$1C:null,add_$1D:function(a){this.$1E=e.Delegate.combine(this.$1E,a)},remove_$1D:function(a){this.$1E=e.Delegate.remove(this.$1E,a)},$1E:null,add_$1F:function(a){this.$20=e.Delegate.combine(this.$20,a)},remove_$1F:function(a){this.$20=e.Delegate.remove(this.$20,a)},$20:null,get_handlerId:function(){return this.$6},set_handlerId:function(a){return this.$6=a,a},get_iframe:function(){return this.$2},get_serverRoot:function(){return this.$3.serverRoot},get_$21:function(){return this.$1},get_$22:function(){return this.$9},get_$23:function(){return this.$A},get_$24:function(){return"none"===this.$2.style.display},get_$25:function(){return this.$3.parentElement},get_$26:function(){return this.$4},get_$27:function(){return this.$7.get_workbook()},get__workbookImpl:function(){return this.$7},get_$28:function(){return this.$B},hideLoadIndicators:function(){e.isValue(this.$5)&&(this.$5.$5(),this.$5=null,delete this.loadFeedback)},handleVizLoad:function(){this.hideLoadIndicators(),this.$3B(),e.isNullOrUndefined(this.$7)?this.$7=new h._WorkbookImpl(this,this.$C,e.Delegate.create(this,function(){this.$48()})):this.$7._update(e.Delegate.create(this,function(){this.$48()}))},handleEventNotification:function(a,b){var c=new h.JavaScriptApi$4(b);if("api.VizInteractiveEvent"===a)e.isValue(this.$7)&&this.$7.get_name()===c.get_$3()&&this.$48(),this.$42();else if("api.MarksSelectionChangedEvent"===a){if(null!=this.$10&&this.$7.get_name()===c.get_$3()){var d=null,f=this.$7.get_activeSheetImpl();if(f.get_name()===c.get_$4())d=f;else if(f.get_isDashboard()){var g=f;d=g.get_worksheets()._get(c.get_$4())._impl}e.isValue(d)&&(d.set_selectedMarks(null),this.$10(new h.MarksEvent("marksselection",this.$1,d)))}}else if("api.FilterChangedEvent"===a){if(null!=this.$12&&this.$7.get_name()===c.get_$3()){var i=null,j=this.$7.get_activeSheetImpl();if(j.get_name()===c.get_$4())i=j;else if(j.get_isDashboard()){var k=j;i=k.get_worksheets()._get(c.get_$4())._impl}if(e.isValue(i)){var l=JSON.parse(c.get_$5()),m=l[0],n=l[1];this.$12(new h.FilterEvent("filterchange",this.$1,i,m,n))}}}else if("api.ParameterChangedEvent"===a){if(null!=this.$14&&this.$7.get_name()===c.get_$3()){this.$7.set_$23(null);var o=c.get_$5();this.$3C(o)}}else if("api.CustomViewsListLoadedEvent"===a){var p=c.get_$5(),q=JSON.parse(p);e.isNullOrUndefined(this.$7)&&(this.$7=new h._WorkbookImpl(this,this.$C,e.Delegate.create(this,function(){this.$48()}))),e.isValue(this.$7)&&h._CustomViewImpl._processCustomViews(this.$7,this.$C,q),this.$43(),null==this.$16||q.customViewLoaded||this.$3D(this.$7.get_activeCustomView())}else if("api.CustomViewUpdatedEvent"===a){var r=c.get_$5(),s=JSON.parse(r);if(e.isNullOrUndefined(this.$7)&&(this.$7=new h._WorkbookImpl(this,this.$C,e.Delegate.create(this,function(){this.$48()}))),e.isValue(this.$7)&&h._CustomViewImpl._processCustomViewUpdate(this.$7,this.$C,s,!0),null!=this.$18)for(var t=this.$7.get_$19()._toApiCollection(),u=0,v=t.length;v>u;u++)this.$3E(t[u])}else if("api.CustomViewRemovedEvent"===a){if(null!=this.$1A)for(var w=this.$7.get_$1A()._toApiCollection(),x=0,y=w.length;y>x;x++)this.$3F(w[x])}else if("api.CustomViewSetDefaultEvent"===a){var z=c.get_$5(),A=JSON.parse(z);if(e.isValue(this.$7)&&h._CustomViewImpl._processCustomViews(this.$7,this.$C,A),null!=this.$1C)for(var B=this.$7.get_$19()._toApiCollection(),C=0,D=B.length;D>C;C++)this.$40(B[C])}else if("api.TabSwitchEvent"===a)this.$7._update(e.Delegate.create(this,function(){if(e.isValue(this.$0)&&this.$0(),this.$7.get_name()===c.get_$3()){var a=c.get_$4(),b=c.get_$5();this.$41(a,b)}this.$48()}));else if("api.StorytellingStateChangedEvent"===a){var E=this.$7.get_activeSheetImpl();"story"===E.get_sheetType()&&E.update(JSON.parse(c.get_$5()))}},addEventListener:function(a,b){var c=h._Enums.$7(a);if("marksselection"===c)this.add_$F(b);else if("parametervaluechange"===c)this.add_$13(b);else if("filterchange"===c)this.add_$11(b);else if("customviewload"===c)this.add_$15(b);else if("customviewsave"===c)this.add_$17(b);else if("customviewremove"===c)this.add_$19(b);else if("customviewsetdefault"===c)this.add_$1B(b);else if("tabswitch"===c)this.add_$1D(b);else{if("storypointswitch"!==c)throw h._TableauException.createUnsupportedEventName(a);this.add_$1F(b)}},removeEventListener:function(a,b){var c=h._Enums.$7(a);if("marksselection"===c)this.remove_$F(b);else if("parametervaluechange"===c)this.remove_$13(b);else if("filterchange"===c)this.remove_$11(b);else if("customviewload"===c)this.remove_$15(b);else if("customviewsave"===c)this.remove_$17(b);else if("customviewremove"===c)this.remove_$19(b);else if("customviewsetdefault"===c)this.remove_$1B(b);else if("tabswitch"===c)this.remove_$1D(b);else{if("storypointswitch"!==c)throw h._TableauException.createUnsupportedEventName(a);this.remove_$1F(b)}},$29:function(){var a=this.$3.$0;e.isValue(a)&&(a.innerHTML="",a.parentNode.removeChild(a),this.$3.$0=a=null),h._VizManagerImpl.$3(this.$1),this.$C.get_router().unregisterHandler(this)},$2A:function(){this.$2.style.display="block"},$2B:function(){this.$2.style.display="none"},$2C:function(){this.$47("showExportImageDialog")},$2D:function(a){var b=this.$44(a);this.$47("showExportDataDialog",b)},$2E:function(a){var b=this.$44(a);this.$47("showExportCrosstabDialog",b)},$2F:function(){this.$47("showExportPDFDialog")},$30:function(){var a=new h._Deferred,b=new h._CommandReturnHandler("api.RevertAllCommand",1,function(){a.resolve()},function(b,c){a.reject(h._TableauException.createServerError(c))});return this._sendCommand(null,b),a.get_promise()},$31:function(){var a=new h._Deferred,b=new h._CommandReturnHandler("api.RefreshDataCommand",1,function(){a.resolve()},function(b,c){a.reject(h._TableauException.createServerError(c))});return this._sendCommand(null,b),a.get_promise()},$32:function(){this.$47("showShareDialog")},$33:function(){if(!this.get__workbookImpl().get_isDownloadAllowed())throw h._TableauException.create("downloadWorkbookNotAllowed","Download workbook is not allowed");this.$47("showDownloadWorkbookDialog")},$34:function(){return this.$45("pauseAutomaticUpdates")},$35:function(){return this.$45("resumeAutomaticUpdates")},$36:function(){return this.$45("toggleAutomaticUpdates")},$37:function(a,b){this.$3.width=a,this.$3.height=b,this.$2.style.width=this.$3.width,this.$2.style.height=this.$3.height,this.$7._updateActiveSheetAsync()},$38:function(a){this.$B=a},$39:function(){return this.$3.$0},$3A:function(){try{h._VizManagerImpl.$2(this.$1)}catch(a){throw this.$29(),a}this.$5=new h._LoadFeedback,this.$5.$3(this.$3),this.$2=this.$4B(),this.$5.$4(),this.$2A(),h._Utility.hasWindowPostMessage()||(h._Utility.isIE()?this.$2.onreadystatechange=this.$4D():this.$2.onload=this.$4D()),this.$A=!this.$3.toolbar,this.$9=!this.$3.tabs,this.$C.get_router().registerHandler(this),this.$46(9999)},$3B:function(){if(h._Utility.hasWindowPostMessage()&&!e.isNullOrUndefined(this.$2)&&e.isValue(this.$2.contentWindow)){var a=h._Utility.elementPosition(this.$2),b=[];b.push("vizOffsetResp"),b.push(a.x),b.push(a.y),this.$2.contentWindow.postMessage(b.join(","),"*")}},_sendCommand:function(a,b){this.$C.sendCommand(a,b)},$3C:function(a){null!=this.$14&&this.$14(new h.ParameterEvent("parametervaluechange",this.$1,a))},$3D:function(a){null!=this.$16&&this.$16(new h.CustomViewEvent("customviewload",this.$1,e.isValue(a)?a._impl:null))},$3E:function(a){null!=this.$18&&this.$18(new h.CustomViewEvent("customviewsave",this.$1,a._impl))},$3F:function(a){null!=this.$1A&&this.$1A(new h.CustomViewEvent("customviewremove",this.$1,a._impl))},$40:function(a){null!=this.$1C&&this.$1C(new h.CustomViewEvent("customviewsetdefault",this.$1,a._impl))},$41:function(a,b){null!=this.$1E&&this.$1E(new h.TabSwitchEvent("tabswitch",this.$1,a,b))},raiseStoryPointSwitch:function(a,b){null!=this.$20&&this.$20(new h.StoryPointSwitchEvent("storypointswitch",this.$1,a,b))},$42:function(){null!=this.$E&&this.$E(this)},$43:function(){null!=this.$D&&this.$D(this)},$44:function(a){if(e.isNullOrUndefined(a))return null;var b=this.$7.$B(a);if(e.isNullOrUndefined(b))throw h._TableauException.createNotActiveSheet();return b.get_name()},$45:function(a){if("pauseAutomaticUpdates"!==a&&"resumeAutomaticUpdates"!==a&&"toggleAutomaticUpdates"!==a)throw h._TableauException.createInternalError(null);var b={};b["api.invokeCommandName"]=a;var c=new h._Deferred,d=new h._CommandReturnHandler("api.InvokeCommandCommand",0,e.Delegate.create(this,function(a){var b=a;e.isValue(b.isAutoUpdate)&&(this.$B=!b.isAutoUpdate),c.resolve(this.$B)}),function(a,b){c.reject(h._TableauException.createServerError(b))});return this._sendCommand(b,d),c.get_promise()},$46:function(a){var b="&:loadOrderID="+a.toString(),c="&:apiID="+this.$6;this.$2.src=this.$4+b+c},$47:function(a,b){if("showExportImageDialog"!==a&&"showExportDataDialog"!==a&&"showExportCrosstabDialog"!==a&&"showExportPDFDialog"!==a&&"showShareDialog"!==a&&"showDownloadWorkbookDialog"!==a)throw h._TableauException.createInternalError(null);var c={};c["api.invokeCommandName"]=a,e.isValue(b)&&(c["api.invokeCommandParam"]=b);var d=new h._CommandReturnHandler("api.InvokeCommandCommand",0,null,null);this._sendCommand(c,d)},$48:function(){if(e.isValue(this.$8)){var a=this.$8;window.setTimeout(e.Delegate.create(this,function(){a(new h.TableauEvent("firstinteractive",this.$1))}),0),this.$8=null}this.$42()},$49:function(){h._Utility.isIE()?"complete"===this.$2.readyState&&this.handleVizLoad():this.handleVizLoad()},$4A:function(){window.setTimeout(e.Delegate.create(this,this.$49),3e3)},$4B:function(){if(e.isNullOrUndefined(this.$39()))return null;var a=document.createElement("IFrame");a.frameBorder="0",a.setAttribute("allowTransparency","true"),a.marginHeight="0",a.marginWidth="0";var b=this.$3.width,c=this.$3.height;return h._Utility.isNumber(b)&&(b+="px"),h._Utility.isNumber(c)&&(c+="px"),a.style.width=b,a.style.height=c,h._Utility.isSafari()&&a.addEventListener("mousewheel",e.Delegate.create(this,this.$4C),!1),this.$39().appendChild(a),a},$4C:function(){},$4D:function(){return e.Delegate.create(this,function(){this.$4A()})}},h._VizManagerImpl=function(){},h._VizManagerImpl.get_$1=function(){return h._VizManagerImpl.$0.concat()},h._VizManagerImpl.$2=function(a){h._VizManagerImpl.$4(a),h._VizManagerImpl.$0.push(a)},h._VizManagerImpl.$3=function(a){for(var b=0,c=h._VizManagerImpl.$0.length;c>b;b++)if(h._VizManagerImpl.$0[b]===a){h._VizManagerImpl.$0.splice(b,1);break}},h._VizManagerImpl.$4=function(a){for(var b=a.getParentElement(),c=0,d=h._VizManagerImpl.$0.length;d>c;c++)if(h._VizManagerImpl.$0[c].getParentElement()===b){var e="Another viz is already present in element '"+h._Utility.elementToString(b)+"'.";throw h._TableauException.create("vizAlreadyInManager",e)}},h._VizParameters=function(a,b,c){if(e.isNullOrUndefined(a)||e.isNullOrUndefined(b))throw h._TableauException.create("noUrlOrParentElementNotFound","URL is empty or Parent element not found");e.isNullOrUndefined(c)?(c={},c.width="800px",c.height="600px",c.hideTabs=!1,c.hideToolbar=!1,c.onFirstInteractive=null):(e.isNullOrUndefined(c.width)&&(c.width="800px"),e.isNullOrUndefined(c.height)&&(c.height="600px"));var d=new e.StringBuilder;d.append('<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; border: 0; padding: 0; margin: 0">'),d.append("</div>");var f=document.createElement("div");f.innerHTML=d.toString(),this.$0=f.firstChild,a.appendChild(this.$0),f.innerHTML="",f=null,this.tabs=!c.hideTabs,this.toolbar=!c.hideToolbar,this.parentElement=a,this.createOptions=c,this.width=this.createOptions.width,this.height=this.createOptions.height,this.toolBarPosition=c.toolbarPosition;var g=b.split("?");this.$1=g[0],this.userSuppliedParameters=2===g.length?g[1]:"";var i=new RegExp(".*?[^/:]/","").exec(this.$1);if(e.isNullOrUndefined(i)||-1===i[0].toLowerCase().indexOf("http://")&&-1===i[0].toLowerCase().indexOf("https://"))throw h._TableauException.create("invalidUrl","Invalid url");this.host_url=i[0].toLowerCase(),this.name=this.$1.replace(i[0],""),this.name=this.name.replace("views/",""),this.serverRoot=decodeURIComponent(this.host_url)},h._VizParameters.prototype={name:"",host_url:null,tabs:!1,toolbar:!1,toolBarPosition:null,width:null,height:null,serverRoot:null,parentElement:null,createOptions:null,userSuppliedParameters:null,$0:null,$1:null,get_url:function(){return this.$2()},get_baseUrl:function(){return this.$1},$2:function(){var a=[];a.push(this.get_baseUrl()),a.push("?"),this.userSuppliedParameters.length>0&&(a.push(this.userSuppliedParameters),a.push("&")),a.push(":embed=y"),a.push("&:showVizHome=no"),this.tabs||a.push("&:tabs=n"),this.toolbar?e.isNullOrUndefined(this.toolBarPosition)||(a.push("&:toolbar="),a.push(this.toolBarPosition)):a.push("&:toolbar=n");var b=this.createOptions,c=b;for(var d in c){var f={key:d,value:c[d]};"embed"!==f.key&&"height"!==f.key&&"width"!==f.key&&"hideTabs"!==f.key&&"hideToolbar"!==f.key&&"onFirstInteractive"!==f.key&&"toolbarPosition"!==f.key&&(a.push("&"),a.push(encodeURIComponent(f.key)),a.push("="),a.push(encodeURIComponent(f.value.toString())))}return a.join("")}},h._WorkbookImpl=function(a,b,c){this.$5=new h._Collection,this.$15=new h._Collection,this.$16=new h._Collection,this.$17=new h._Collection,this.$1=a,this.$7=b,this.$10(c)},h._WorkbookImpl.$8=function(a){switch(a){case"dashboard":return"dashboard";case"story":return"story";case"worksheet":return"worksheet";default:throw h._TableauException.createInternalError("Unknown sheetType '"+a+"'")}},h._WorkbookImpl.$9=function(a){a=a||[];for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.zoneType,f="blank";switch(e){case"color":case"shape":case"size":case"map":f="legend";break;case"layout-basic":case"layout-flow":continue;case"filter":f="quickFilter";break;case"viz":f="worksheet";break;case"paramctrl":f="parameterControl";break;case"empty":f="blank";break;case"title":f="title";break;case"text":f="text";break;case"bitmap":f="image";break;case"web":f="webPage"}var g=h.$create_Size(d.width,d.height),i=h.$create_Point(d.x,d.y),j=d.name,k=h.$create_JavaScriptApi$2(j,f,i,g,d.zoneId);b.push(k)}return b},h._WorkbookImpl.$A=function(a){if(e.isNullOrUndefined(a))return null;if(h._Utility.isString(a))return a;var b=a,c=e.Delegate.create(b,b.getName);return e.isValue(c)?c():null},h._WorkbookImpl.$E=function(a){if(e.isNullOrUndefined(a))return h.SheetSizeFactory.createAutomatic();var b=a.minHeight,c=a.minWidth,d=a.maxHeight,f=a.maxWidth,g="automatic",i=null,j=null;return b||c?d||f?d===b&&f===c?(g="exactly",i=h.$create_Size(c,b),j=h.$create_Size(c,b)):(g="range",i=h.$create_Size(c,b),j=h.$create_Size(f,d)):(g="atleast",i=h.$create_Size(c,b)):(d||f)&&(g="atmost",j=h.$create_Size(f,d)),h.$create_SheetSize(g,i,j)},h._WorkbookImpl.$28=function(a){for(var b=new h._Collection,c=e.IEnumerator.getEnumerator(a.parameters);c.moveNext();){var d=c.current,f=new h._ParameterImpl(d);b._add(f.get_$B(),f.get_$A())}return b},h._WorkbookImpl.$29=function(a,b){for(var c=e.IEnumerator.getEnumerator(b.parameters);c.moveNext();){var d=c.current;if(d.name===a)return new h._ParameterImpl(d)}return null},h._WorkbookImpl.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$6:!1,$7:null,get_workbook:function(){return e.isNullOrUndefined(this.$0)&&(this.$0=new tableauSoftware.Workbook(this)),this.$0},get_viz:function(){return this.$1.get_$21()},get_publishedSheets:function(){return this.$5},get_name:function(){return this.$2},get_activeSheetImpl:function(){return this.$3},get_activeCustomView:function(){return this.$14},get_isDownloadAllowed:function(){return this.$6},$B:function(a){if(e.isNullOrUndefined(this.$3))return null;var b=h._WorkbookImpl.$A(a);if(e.isNullOrUndefined(b))return null;if(b===this.$3.get_name())return this.$3;if(this.$3.get_isDashboard()){var c=this.$3,d=c.get_worksheets()._get(b);if(e.isValue(d))return d._impl}return null},_setActiveSheetAsync:function(a){if(h._Utility.isNumber(a)){var b=a;if(b<this.$5.get__length()&&b>=0)return this.$C(this.$5.get_item(b).$0);throw h._TableauException.createIndexOutOfRange(b)}var c=h._WorkbookImpl.$A(a),d=this.$5._get(c);if(e.isValue(d))return this.$C(d.$0);if(this.$3.get_isDashboard()){var f=this.$3,g=f.get_worksheets()._get(c);if(e.isValue(g)){this.$4=null;var i="";return g.getIsHidden()?this.$4=g._impl:i=g._impl.get_url(),this.$D(g._impl.get_name(),i)}}throw h._TableauException.create("sheetNotInWorkbook","Sheet is not found in Workbook")},_revertAllAsync:function(){var a=new h._Deferred,b=new h._CommandReturnHandler("api.RevertAllCommand",1,function(){a.resolve()},function(b,c){a.reject(h._TableauException.createServerError(c))});return this.$F(null,b),a.get_promise()},_update:function(a){this.$10(a)},$C:function(a){return this.$D(a.name,a.url)},$D:function(a,b){var c=new h._Deferred;if(e.isValue(this.$3)&&a===this.$3.get_name())return c.resolve(this.$3.get_sheet()),c.get_promise();var d={};d["api.switchToSheetName"]=a,d["api.switchToRepositoryUrl"]=b,d["api.oldRepositoryUrl"]=this.$3.get_url();var f=new h._CommandReturnHandler("api.SwitchActiveSheetCommand",0,e.Delegate.create(this,function(){this.$1.$0=e.Delegate.create(this,function(){this.$1.$0=null,c.resolve(this.$3.get_sheet())})}),function(a,b){c.reject(h._TableauException.createServerError(b))});return this.$F(d,f),c.get_promise()},_updateActiveSheetAsync:function(){var a=new h._Deferred,b={};b["api.switchToSheetName"]=this.$3.get_name(),b["api.switchToRepositoryUrl"]=this.$3.get_url(),b["api.oldRepositoryUrl"]=this.$3.get_url();var c=new h._CommandReturnHandler("api.UpdateActiveSheetCommand",0,e.Delegate.create(this,function(){a.resolve(this.$3.get_sheet())}),function(b,c){a.reject(h._TableauException.createServerError(c))});return this.$F(b,c),a.get_promise()},$F:function(a,b){this.$7.sendCommand(a,b)},$10:function(a){var b=new h._CommandReturnHandler("api.GetClientInfoCommand",0,e.Delegate.create(this,function(b){var c=b;this.$11(c),e.isValue(a)&&a()}),null);this.$F(null,b)},$11:function(a){this.$2=a.workbookName,this.$6=a.isDownloadAllowed,this.$1.$38(!a.isAutoUpdate),this.$13(a),this.$12(a)},$12:function(a){var b=a.currentSheetName,c=this.$5._get(b);if(e.isNullOrUndefined(c)&&e.isNullOrUndefined(this.$4))throw h._TableauException.createInternalError("The active sheet was not specified in baseSheets");if(!e.isValue(this.$3)||this.$3.get_name()!==b){if(e.isValue(this.$3)){this.$3.set_isActive(!1);var d=this.$5._get(this.$3.get_name());if(e.isValue(d)&&(d.$0.isActive=!1),"story"===this.$3.get_sheetType()){var f=this.$3;f.remove_activeStoryPointChange(e.Delegate.create(this.$1,this.$1.raiseStoryPointSwitch))}}if(e.isValue(this.$4)){var g=h.$create__SheetInfoImpl(this.$4.get_name(),"worksheet",-1,this.$4.get_size(),this.get_workbook(),"",!0,!0,4294967295);this.$4=null,this.$3=new h._WorksheetImpl(g,this,this.$7,null)}else{for(var i=null,j=0,k=a.publishedSheets.length;k>j;j++)if(a.publishedSheets[j].name===b){i=a.publishedSheets[j];break}if(e.isNullOrUndefined(i))throw h._TableauException.createInternalError("No base sheet was found corresponding to the active sheet.");var l=e.Delegate.create(this,function(a){return this.$5._get(a)});if("dashboard"===i.sheetType){var m=new h._DashboardImpl(c.$0,this,this.$7);this.$3=m;var n=h._WorkbookImpl.$9(a.dashboardZones);m.$11(n,l)}else if("story"===i.sheetType){var o=new h._StoryImpl(c.$0,this,this.$7,a.story,l);this.$3=o,o.add_activeStoryPointChange(e.Delegate.create(this.$1,this.$1.raiseStoryPointSwitch))}else this.$3=new h._WorksheetImpl(c.$0,this,this.$7,null);c.$0.isActive=!0}this.$3.set_isActive(!0)}},$13:function(a){var b=a.publishedSheets;if(!e.isNullOrUndefined(b))for(var c=0;c<b.length;c++){var d=b[c],f=d.name,g=this.$5._get(f),i=h._WorkbookImpl.$E(d);if(e.isNullOrUndefined(g)){var j=f===a.currentSheetName,k=h._WorkbookImpl.$8(d.sheetType),l=h.$create__SheetInfoImpl(f,k,c,i,this.get_workbook(),d.repositoryUrl,j,!1,4294967295);g=new tableauSoftware.SheetInfo(l),this.$5._add(f,g)}else g.$0.size=i}},$14:null,get_$18:function(){return this.$15},set_$18:function(a){return this.$15=a,a},get_$19:function(){return this.$16},set_$19:function(a){return this.$16=a,a},get_$1A:function(){return this.$17},set_$1A:function(a){return this.$17=a,a},get_$1B:function(){return this.$14},set_$1B:function(a){return this.$14=a,a},$1C:function(){return h._CustomViewImpl._getCustomViewsAsync(this,this.$7)},$1D:function(a){if(e.isNullOrUndefined(a)||h._Utility.isNullOrEmpty(a))return h._CustomViewImpl._showCustomViewAsync(this,this.$7,null);var b=this.$15._get(a);if(e.isNullOrUndefined(b)){var c=new h._Deferred;return c.reject(h._TableauException.createInvalidCustomViewName(a)),c.get_promise()}return b._impl._showAsync()},$1E:function(a){if(h._Utility.isNullOrEmpty(a))throw h._TableauException.createNullOrEmptyParameter("customViewName");var b=this.$15._get(a);if(e.isNullOrUndefined(b)){var c=new h._Deferred;return c.reject(h._TableauException.createInvalidCustomViewName(a)),c.get_promise()}return b._impl.$12()},$1F:function(a){if(h._Utility.isNullOrEmpty(a))throw h._TableauException.createInvalidParameter("customViewName");return h._CustomViewImpl._saveNewAsync(this,this.$7,a)},$20:function(){return h._CustomViewImpl._makeCurrentCustomViewDefaultAsync(this,this.$7)},$21:null,$22:null,get_$23:function(){return this.$22},set_$23:function(a){return this.$22=a,a},get_$24:function(){return this.$21},$25:function(a){var b=new h._Deferred;if(e.isValue(this.$22))return b.resolve(this.$22.get_$A()),b.get_promise();var c={},d=new h._CommandReturnHandler("api.FetchParametersCommand",0,e.Delegate.create(this,function(c){var d=c,e=h._WorkbookImpl.$29(a,d);this.$22=e,b.resolve(e.get_$A())}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.$F(c,d),b.get_promise()},$26:function(){var a=new h._Deferred,b={},c=new h._CommandReturnHandler("api.FetchParametersCommand",0,e.Delegate.create(this,function(b){var c=b;this.$21=h._WorkbookImpl.$28(c),a.resolve(this.get_$24()._toApiCollection())}),function(b,c){a.reject(h._TableauException.createServerError(c))});return this.$F(b,c),a.get_promise()},$27:function(a,b){var c=new h._Deferred,d=null;if(e.isValue(this.$21)){if(e.isNullOrUndefined(this.$21._get(a)))return c.reject(h._TableauException.createInvalidParameter(a)),c.get_promise();if(d=this.$21._get(a)._impl,e.isNullOrUndefined(d))return c.reject(h._TableauException.createInvalidParameter(a)),c.get_promise()}var f={};if(f["api.setParameterName"]=e.isValue(this.$21)?d.get_$B():a,e.isValue(b)&&h._Utility.isDate(b)){var g=b,i=h._Utility.serializeDateForServer(g);f["api.setParameterValue"]=i}else f["api.setParameterValue"]=e.isValue(b)?b.toString():null;this.$22=null;var j=new h._CommandReturnHandler("api.SetParameterValueCommand",0,e.Delegate.create(this,function(b){var d=b;if(e.isNullOrUndefined(d))return void c.reject(h._TableauException.create("serverError","server error"));if(!d.isValidPresModel)return void c.reject(h._TableauException.createInvalidParameter(a));var f=new h._ParameterImpl(d);this.$22=f,c.resolve(f.get_$A())}),function(){c.reject(h._TableauException.createInvalidParameter(a))});return this.$F(f,j),c.get_promise()}},h._WorksheetImpl=function(a,b,c,d){this.$F=new h._Collection,this.$15=new h._Collection,this.$27=new h._Collection,h._WorksheetImpl.initializeBase(this,[a,b,c]),this.$10=d},h._WorksheetImpl.$16=function(a){if(e.isValue(a.invalidFieldCaption))return h._TableauException.create("invalidFilterFieldName",a.invalidFieldCaption);if(e.isValue(a.invalidValues))return h._TableauException.create("invalidFilterFieldValue",a.invalidValues);if(e.isValue(a.invalidAggFieldName)){var b=a.fieldCaption;return h._TableauException.$0(b)}return null},h._WorksheetImpl.$1E=function(a){if(e.isNullOrUndefined(a))throw h._TableauException.createNullOrEmptyParameter("filterOptions");if(e.isNullOrUndefined(a.min)&&e.isNullOrUndefined(a.max))throw h._TableauException.create("invalidParameter","At least one of filterOptions.min or filterOptions.max must be specified.");var b={};return e.isValue(a.min)&&(b.min=a.min),e.isValue(a.max)&&(b.max=a.max),e.isValue(a.nullOption)&&(b.nullOption=h._Enums.$5(a.nullOption,"filterOptions.nullOption")),b},h._WorksheetImpl.$1F=function(a){if(e.isNullOrUndefined(a))throw h._TableauException.createNullOrEmptyParameter("filterOptions");var b={};if(b.rangeType=h._Enums.$1(a.rangeType,"filterOptions.rangeType"),b.periodType=h._Enums.$0(a.periodType,"filterOptions.periodType"),"lastn"===b.rangeType||"nextn"===b.rangeType){if(e.isNullOrUndefined(a.rangeN))throw h._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");b.rangeN=h._Utility.toInt(a.rangeN)}if(e.isValue(a.anchorDate)){if(!h._Utility.isDate(a.anchorDate)||!h._Utility.isDateValid(a.anchorDate))throw h._TableauException.createInvalidDateParameter("filterOptions.anchorDate");b.anchorDate=a.anchorDate}return b},h._WorksheetImpl.$20=function(a,b,c){return new h._CommandReturnHandler(a,1,function(a){var d=h._WorksheetImpl.$16(a);null==d?c.resolve(b):c.reject(d)},function(a,d){if(a)c.reject(h._TableauException.createInvalidFilterFieldNameOrValue(b));else{var e=h._TableauException.create("filterCannotBePerformed",d);c.reject(e)}})},h._WorksheetImpl.$2B=function(a){return e.isValue(a.invalidFields)?h._TableauException.create("invalidSelectionFieldName",a.invalidFields):e.isValue(a.invalidValues)?h._TableauException.create("invalidSelectionValue",a.invalidValues):e.isValue(a.invalidDates)?h._TableauException.create("invalidSelectionDate",a.invalidDates):null},h._WorksheetImpl.prototype={$E:null,$10:null,get__dataSources:function(){return this.$F},set__dataSources:function(a){return this.$F=a,a},get_sheet:function(){return this.get_worksheet()},get_worksheet:function(){return null==this.$E&&(this.$E=new tableauSoftware.Worksheet(this)),this.$E},get_parentDashboardImpl:function(){return this.$10},get_parentDashboard:function(){return e.isValue(this.$10)?this.$10.get_dashboard():null},$11:function(){this.$13();var a=new h._Deferred,b={},c=new h._CommandReturnHandler("api.GetDataSourcesCommand",0,e.Delegate.create(this,function(b){var c=b,d=h.JavaScriptApi$3.$B(c,this.get_name());this.set__dataSources(d),a.resolve(d._toApiCollection())}),function(b,c){a.reject(h._TableauException.createServerError(c))});return this.sendCommand(b,c),a.get_promise()},$12:function(a){this.$13();var b=new h._Deferred,c={},d=new h._CommandReturnHandler("api.GetDataSourcesCommand",0,e.Delegate.create(this,function(c){var d=c,e=h.JavaScriptApi$3.$B(d,this.get_name());this.set__dataSources(e);for(var f=0;f<e.get__length();f++){var g=e.get_item(f);g.getName()===a&&b.resolve(g)}b.reject(h._TableauException.create("serverError","datasource not found"))}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(c,d),b.get_promise()},$13:function(){var a=this.get_isActive(),b=e.isValue(this.$10)&&this.$10.get_isActive(),c=e.isValue(this.get_parentStoryPointImpl())&&this.get_parentStoryPointImpl().get_parentStoryImpl().get_isActive();if(!a&&!b&&!c)throw h._TableauException.createNotActiveSheet()},$14:function(a){if(e.isValue(this.get_parentStoryPointImpl())){var b={};b.worksheet=this.get_name(),e.isValue(this.get_parentDashboardImpl())&&(b.dashboard=this.get_parentDashboardImpl().get_name()),b.flipboardZoneId=this.get_parentStoryPointImpl().get_containedSheetImpl().get_zoneId(),b.storyboard=this.get_parentStoryPointImpl().get_parentStoryImpl().get_name(),b.storyPointId=this.get_parentStoryPointImpl().get_storyPointId(),a["api.visualId"]=b}else a["api.worksheetName"]=this.get_name(),e.isValue(this.get_parentDashboardImpl())&&(a["api.dashboardName"]=this.get_parentDashboardImpl().get_name())},get__filters:function(){return this.$15},set__filters:function(a){return this.$15=a,a},$17:function(a,b,c){if(!h._Utility.isNullOrEmpty(a)&&!h._Utility.isNullOrEmpty(b))throw h._TableauException.createInternalError("Only fieldName OR fieldCaption is allowed, not both.");c=c||{};var d=new h._Deferred,f={};this.$14(f),!h._Utility.isNullOrEmpty(b)&&h._Utility.isNullOrEmpty(a)&&(f["api.fieldCaption"]=b),h._Utility.isNullOrEmpty(a)||(f["api.fieldName"]=a),f["api.filterHierarchicalLevels"]=0,f["api.ignoreDomain"]=c.ignoreDomain||!1;var g=new h._CommandReturnHandler("api.GetOneFilterInfoCommand",0,e.Delegate.create(this,function(a){var b=h._WorksheetImpl.$16(a);if(null==b){var c=a,e=tableauSoftware.Filter.$7(this,c);d.resolve(e)}else d.reject(b)}),function(a,b){d.reject(h._TableauException.createServerError(b))});return this.sendCommand(f,g),d.get_promise()},$18:function(a){this.$13(),a=a||{};
var b=new h._Deferred,c={};this.$14(c),c["api.ignoreDomain"]=a.ignoreDomain||!1;var d=new h._CommandReturnHandler("api.GetFiltersListCommand",0,e.Delegate.create(this,function(a){var c=a;this.set__filters(tableauSoftware.Filter.$8(this,c)),b.resolve(this.get__filters()._toApiCollection())}),function(a,c){b.reject(h._TableauException.createServerError(c))});return this.sendCommand(c,d),b.get_promise()},$19:function(a,b,c,d){return this.$22(a,b,c,d)},$1A:function(a){return this.$21(a)},$1B:function(a,b){var c=h._WorksheetImpl.$1E(b);return this.$23(a,c)},$1C:function(a,b){var c=h._WorksheetImpl.$1F(b);return this.$24(a,c)},$1D:function(a,b,c,d){if(e.isNullOrUndefined(b)&&"all"!==c)throw h._TableauException.createInvalidParameter("values");return this.$25(a,b,c,d)},$21:function(a){if(this.$13(),h._Utility.isNullOrEmpty(a))throw h._TableauException.createNullOrEmptyParameter("fieldName");var b=new h._Deferred,c={};c["api.fieldCaption"]=a,this.$14(c);var d=h._WorksheetImpl.$20("api.ClearFilterCommand",a,b);return this.sendCommand(c,d),b.get_promise()},$22:function(a,b,c,d){if(this.$13(),h._Utility.isNullOrEmpty(a))throw h._TableauException.createNullOrEmptyParameter("fieldName");c=h._Enums.$2(c,"updateType");var f=[];if(h._jQueryShim.$12(b))for(var g=0;g<b.length;g++)f.push(b[g].toString());else e.isValue(b)&&f.push(b.toString());var i=new h._Deferred,j={};j["api.fieldCaption"]=a,j["api.filterUpdateType"]=c,j["api.exclude"]=e.isValue(d)&&d.isExcludeMode?!0:!1,"all"!==c&&(j["api.filterCategoricalValues"]=f),this.$14(j);var k=h._WorksheetImpl.$20("api.ApplyCategoricalFilterCommand",a,i);return this.sendCommand(j,k),i.get_promise()},$23:function(a,b){if(this.$13(),h._Utility.isNullOrEmpty(a))throw h._TableauException.createNullOrEmptyParameter("fieldName");if(e.isNullOrUndefined(b))throw h._TableauException.createNullOrEmptyParameter("filterOptions");var c={};if(c["api.fieldCaption"]=a,e.isValue(b.min))if(h._Utility.isDate(b.min)){var d=b.min;if(!h._Utility.isDateValid(d))throw h._TableauException.createInvalidDateParameter("filterOptions.min");c["api.filterRangeMin"]=h._Utility.serializeDateForServer(d)}else c["api.filterRangeMin"]=b.min;if(e.isValue(b.max))if(h._Utility.isDate(b.max)){var f=b.max;if(!h._Utility.isDateValid(f))throw h._TableauException.createInvalidDateParameter("filterOptions.max");c["api.filterRangeMax"]=h._Utility.serializeDateForServer(f)}else c["api.filterRangeMax"]=b.max;e.isValue(b.nullOption)&&(c["api.filterRangeNullOption"]=b.nullOption),this.$14(c);var g=new h._Deferred,i=h._WorksheetImpl.$20("api.ApplyRangeFilterCommand",a,g);return this.sendCommand(c,i),g.get_promise()},$24:function(a,b){if(this.$13(),h._Utility.isNullOrEmpty(a))throw h._TableauException.createInvalidParameter("fieldName");if(e.isNullOrUndefined(b))throw h._TableauException.createInvalidParameter("filterOptions");var c={};if(c["api.fieldCaption"]=a,e.isValue(b)){if(c["api.filterPeriodType"]=b.periodType,c["api.filterDateRangeType"]=b.rangeType,"lastn"===b.rangeType||"nextn"===b.rangeType){if(e.isNullOrUndefined(b.rangeN))throw h._TableauException.create("missingRangeNForRelativeDateFilters","Missing rangeN field for a relative date filter of LASTN or NEXTN.");c["api.filterDateRange"]=b.rangeN}e.isValue(b.anchorDate)&&(c["api.filterDateArchorValue"]=h._Utility.serializeDateForServer(b.anchorDate))}this.$14(c);var d=new h._Deferred,f=h._WorksheetImpl.$20("api.ApplyRelativeDateFilterCommand",a,d);return this.sendCommand(c,f),d.get_promise()},$25:function(a,b,c,d){if(this.$13(),h._Utility.isNullOrEmpty(a))throw h._TableauException.createNullOrEmptyParameter("fieldName");c=h._Enums.$2(c,"updateType");var f=null,g=null;if(h._jQueryShim.$12(b)){f=[];for(var i=b,j=0;j<i.length;j++)f.push(i[j].toString())}else if(h._Utility.isString(b))f=[],f.push(b.toString());else if(e.isValue(b)&&e.isValue(b.levels)){var k=b.levels;if(g=[],h._jQueryShim.$12(k))for(var l=k,m=0;m<l.length;m++)g.push(l[m].toString());else g.push(k.toString())}else if(e.isValue(b))throw h._TableauException.createInvalidParameter("values");var n={};n["api.fieldCaption"]=a,n["api.filterUpdateType"]=c,n["api.exclude"]=e.isValue(d)&&d.isExcludeMode?!0:!1,null!=f&&(n["api.filterHierarchicalValues"]=h.JsonUtil.toJson(f,!1,"")),null!=g&&(n["api.filterHierarchicalLevels"]=h.JsonUtil.toJson(g,!1,"")),this.$14(n);var o=new h._Deferred,p=h._WorksheetImpl.$20("api.ApplyHierarchicalFilterCommand",a,o);return this.sendCommand(n,p),o.get_promise()},get_selectedMarks:function(){return this.$27},set_selectedMarks:function(a){return this.$27=a,a},$28:function(){this.$13();var a=new h._Deferred,b={};this.$14(b),b["api.filterUpdateType"]="replace";var c=new h._CommandReturnHandler("api.SelectMarksCommand",1,function(){a.resolve()},function(b,c){a.reject(h._TableauException.createServerError(c))});return this.sendCommand(b,c),a.get_promise()},$29:function(a,b,c){return this.$13(),null==a&&null==b?this.$28():h._Utility.isString(a)&&(h._jQueryShim.$12(b)||h._Utility.isString(b)||!h._Enums.$4(b))?this.$2C(a,b,c):h._jQueryShim.$12(a)?this.$2E(a,b):this.$2D(a,b)},$2A:function(){this.$13();var a=new h._Deferred,b={};this.$14(b);var c=new h._CommandReturnHandler("api.FetchSelectedMarksCommand",0,e.Delegate.create(this,function(b){var c=b;this.$27=h._MarkImpl.$6(c),a.resolve(this.$27._toApiCollection())}),function(b,c){a.reject(h._TableauException.createServerError(c))});return this.sendCommand(b,c),a.get_promise()},$2C:function(a,b,c){var d=[],e=[],f=[],g=[],h=[],i=[];return this.$2F(d,e,f,g,h,i,a,b),this.$31(null,d,e,f,g,h,i,c)},$2D:function(a,b){var c=a,d=[],e=[],f=[],g=[],i=[],j=[],k=c;for(var l in k){var m={key:l,value:k[l]};a.hasOwnProperty(m.key)&&(h._jQueryShim.$11(c[m.key])||this.$2F(d,e,f,g,i,j,m.key,m.value))}return this.$31(null,d,e,f,g,i,j,b)},$2E:function(a,b){for(var c=[],d=[],f=[],g=[],i=[],j=[],k=[],l=0;l<a.length;l++){var m=a[l];if(e.isValue(m.$0.get_$4())&&m.$0.get_$4()>0)k.push(m.$0.get_$4());else for(var n=m.$0.get_$3(),o=0;o<n.get__length();o++){var p=n.get_item(o);p.hasOwnProperty("fieldName")&&p.hasOwnProperty("value")&&!h._jQueryShim.$11(p.fieldName)&&!h._jQueryShim.$11(p.value)&&this.$2F(c,d,f,g,i,j,p.fieldName,p.value)}}return this.$31(k,c,d,f,g,i,j,b)},$2F:function(a,b,c,d,f,g,i,j){var k=j;if(h._WorksheetImpl.$26.test(i))this.$30(c,d,i,j);else if(e.isValue(k.min)||e.isValue(k.max)){var l={};if(e.isValue(k.min))if(h._Utility.isDate(k.min)){var m=k.min;if(!h._Utility.isDateValid(m))throw h._TableauException.createInvalidDateParameter("options.min");l.min=h._Utility.serializeDateForServer(m)}else l.min=k.min;if(e.isValue(k.max))if(h._Utility.isDate(k.max)){var n=k.max;if(!h._Utility.isDateValid(n))throw h._TableauException.createInvalidDateParameter("options.max");l.max=h._Utility.serializeDateForServer(n)}else l.max=k.max;if(e.isValue(k.nullOption)){var o=h._Enums.$5(k.nullOption,"options.nullOption");l.nullOption=o}else l.nullOption="allValues";var p=h.JsonUtil.toJson(l,!1,"");this.$30(f,g,i,p)}else this.$30(a,b,i,j)},$30:function(a,b,c,d){var e=[];if(h._jQueryShim.$12(d))for(var f=d,g=0;g<f.length;g++)e.push(f[g]);else e.push(d);b.push(e),a.push(c)},$31:function(a,b,c,d,e,f,g,i){var j={};if(this.$14(j),i=h._Enums.$3(i,"updateType"),j["api.filterUpdateType"]=i,h._Utility.isNullOrEmpty(a)||(j["api.tupleIds"]=h.JsonUtil.toJson(a,!1,"")),!h._Utility.isNullOrEmpty(b)&&!h._Utility.isNullOrEmpty(c)){j["api.categoricalFieldCaption"]=h.JsonUtil.toJson(b,!1,"");for(var k=[],l=0;l<c.length;l++){var m=h.JsonUtil.toJson(c[l],!1,"");k.push(m)}j["api.categoricalMarkValues"]=h.JsonUtil.toJson(k,!1,"")}if(!h._Utility.isNullOrEmpty(d)&&!h._Utility.isNullOrEmpty(e)){j["api.hierarchicalFieldCaption"]=h.JsonUtil.toJson(d,!1,"");for(var n=[],o=0;o<e.length;o++){var p=h.JsonUtil.toJson(e[o],!1,"");n.push(p)}j["api.hierarchicalMarkValues"]=h.JsonUtil.toJson(n,!1,"")}if(!h._Utility.isNullOrEmpty(f)&&!h._Utility.isNullOrEmpty(g)){j["api.rangeFieldCaption"]=h.JsonUtil.toJson(f,!1,"");for(var q=[],r=0;r<g.length;r++){var s=h.JsonUtil.toJson(g[r],!1,"");q.push(s)}j["api.rangeMarkValues"]=h.JsonUtil.toJson(q,!1,"")}if(h._Utility.isNullOrEmpty(j["api.tupleIds"])&&h._Utility.isNullOrEmpty(j["api.categoricalFieldCaption"])&&h._Utility.isNullOrEmpty(j["api.hierarchicalFieldCaption"])&&h._Utility.isNullOrEmpty(j["api.rangeFieldCaption"]))throw h._TableauException.createInvalidParameter("fieldNameOrFieldValuesMap");var t=new h._Deferred,u=new h._CommandReturnHandler("api.SelectMarksCommand",1,function(a){var b=h._WorksheetImpl.$2B(a);null==b?t.resolve():t.reject(b)},function(a,b){t.reject(h._TableauException.createServerError(b))});return this.sendCommand(j,u),t.get_promise()}},h.JsonUtil=function(){},h.JsonUtil.parseJson=function(a){return h._jQueryShim.parseJSON(a)},h.JsonUtil.toJson=function(a,b,c){b=b||!1,c=c||"";var d=[];return h.JsonUtil.$3(a,b,c,d)},h.JsonUtil.$1=function(a,b,c){if(e.isValue(Array.prototype.indexOf))return a.indexOf(b,c);c=c||0;var d=a.length;if(d>0)for(var f=c;d>f;f++)if(a[f]===b)return f;return-1},h.JsonUtil.$2=function(a,b,c){var d=h.JsonUtil.$1(a,b,c);return d>=0},h.JsonUtil.$3=function(a,b,c,d){if(h.JsonUtil.$2(d,a))throw Error.createError("The object contains recursive reference of sub-objects",null);if(e.isUndefined(a))return"undefined";if(null==a)return"null";var f=h._jQueryShim.$13(a);if("number"===f||"boolean"===f)return a.toString();if("string"===f)return h.JsonUtil.$6(a);d.push(a);var g;c=c||"";var i=b?c+"	":"",j=a.__json__||a.json;if(h._jQueryShim.$11(j)){var k=j;if(g=k(a),a!==g){var l=h.JsonUtil.$3(g,b,i,d);return d.pop(),l}}if(e.isValue(a.nodeType)&&e.isValue(a.cloneNode))throw Error.createError("Can't serialize DOM nodes",null);var m=b?" ":"",n=b?"\n":"";return h._jQueryShim.$12(a)?h.JsonUtil.$5(a,b,c,d,i,n):"function"===f?(d.pop(),null):h.JsonUtil.$4(a,b,c,d,i,n,m)},h.JsonUtil.$4=function(a,b,c,d,f,g,i){var j=a,k=new e.StringBuilder("{"),l=!1,m=j;for(var n in m){var o,p,q={key:n,value:m[n]};if("number"==typeof q.key)o='"'+q.key+'"';else{if("string"!=typeof q.key)continue;o=h.JsonUtil.$6(q.key)}p=h.JsonUtil.$3(q.value,b,f,d),null!=p&&(l&&k.append(","),k.append(g+f+o+":"+i+p),l=!0)}return k.append(g+c+"}"),d.pop(),k.toString()},h.JsonUtil.$5=function(a,b,c,d,f,g){for(var i=!1,j=new e.StringBuilder("["),k=a,l=0;l<k.length;l++){var m=k[l],n=h.JsonUtil.$3(m,b,f,d);null==n&&(n="undefined"),i&&j.append(","),j.append(g+f+n),i=!0}return j.append(g+c+"]"),d.pop(),j.toString()},h.JsonUtil.$6=function(a){return a='"'+a.replace(/(["\\])/g,"\\$1")+'"',a=a.replace(new RegExp("[\f]","g"),"\\f"),a=a.replace(new RegExp("[\b]","g"),"\\b"),a=a.replace(new RegExp("[\n]","g"),"\\n"),a=a.replace(new RegExp("[	]","g"),"\\t"),a=a.replace(new RegExp("[\r]","g"),"\\r")},f.registerNamespace("tableauSoftware"),h.$create_DataValue=function(a,b,c){var d={};return d.value=a,d.formattedValue=h._Utility.isNullOrEmpty(c)?b:c,d},h.$create_Point=function(a,b){var c={};return c.x=a,c.y=b,c},h.$create_Size=function(a,b){var c={};return c.width=a,c.height=b,c},h.$create_SheetSize=function(a,b,c){var d={};return d.behavior=a||"automatic",e.isValue(b)&&(d.minSize=b),e.isValue(c)&&(d.maxSize=c),d},tableauSoftware.CustomView=function(a){this._impl=a},tableauSoftware.CustomView.prototype={_impl:null,getWorkbook:function(){return this._impl.get_$B()},getUrl:function(){return this._impl.get_$C()},getName:function(){return this._impl.get_$D()},setName:function(a){this._impl.set_$D(a)},getOwnerName:function(){return this._impl.get_$E()},getAdvertised:function(){return this._impl.get_$F()},setAdvertised:function(a){this._impl.set_$F(a)},getDefault:function(){return this._impl.get_$10()},saveAsync:function(){return this._impl.$11()}},h.CustomViewEvent=function(a,b,c){h.CustomViewEvent.initializeBase(this,[a,b]),this.$2=new h.JavaScriptApi$6(b._impl.get__workbookImpl(),c)},h.CustomViewEvent.prototype={$2:null,getCustomViewAsync:function(){var a=new h._Deferred;return a.resolve(this.$2.get__customViewImpl().get_$A()),a.get_promise()}},h.JavaScriptApi$6=function(a,b){h.JavaScriptApi$6.initializeBase(this,[a,null]),this.$2=b},h.JavaScriptApi$6.prototype={$2:null,get__customViewImpl:function(){return this.$2}},tableauSoftware.Dashboard=function(a){tableauSoftware.Dashboard.initializeBase(this,[a])},tableauSoftware.Dashboard.prototype={_impl:null,getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getObjects:function(){return this._impl.get_objects()._toApiCollection()},getWorksheets:function(){return this._impl.get_worksheets()._toApiCollection()}},tableauSoftware.DashboardObject=function(a,b,c){if("worksheet"===a.$0&&e.isNullOrUndefined(c))throw h._TableauException.createInternalError("worksheet parameter is required for WORKSHEET objects");if("worksheet"!==a.$0&&e.isValue(c))throw h._TableauException.createInternalError("worksheet parameter should be undefined for non-WORKSHEET objects");this.$0=a,this.$1=b,this.$2=c},tableauSoftware.DashboardObject.prototype={$0:null,$1:null,$2:null,getObjectType:function(){return this.$0.$0},getDashboard:function(){return this.$1},getWorksheet:function(){return this.$2},getPosition:function(){return this.$0.$2},getSize:function(){return this.$0.$3}},tableauSoftware.DataSource=function(a){this.$0=a},tableauSoftware.DataSource.prototype={$0:null,getName:function(){return this.$0.get_$6()},getFields:function(){return this.$0.get_$7()._toApiCollection()},getIsPrimary:function(){return this.$0.get_$8()}},tableauSoftware.Field=function(a,b,c,d){this.$0=a,this.$1=b,this.$2=c,this.$3=d},tableauSoftware.Field.prototype={$0:null,$1:null,$2:null,$3:null,getDataSource:function(){return this.$0},getName:function(){return this.$1},getRole:function(){return this.$2},getAggregation:function(){return this.$3}},tableauSoftware.CategoricalFilter=function(a,b){tableauSoftware.CategoricalFilter.initializeBase(this,[a,b]),this.$D(b)},tableauSoftware.CategoricalFilter.prototype={$B:!1,$C:null,getIsExcludeMode:function(){return this.$B},getAppliedValues:function(){return this.$C},_updateFromJson:function(a){this.$D(a)},$D:function(a){if(this.$B=a.isExclude,e.isValue(a.catAppliedValues)){this.$C=[];for(var b=e.IEnumerator.getEnumerator(a.catAppliedValues);b.moveNext();){var c=b.current;this.$C.push(h._Utility.getDataValue(c))}}}},tableauSoftware.Filter=function(a,b){this.$0=a,this.$A(b)},tableauSoftware.Filter.$7=function(a,b){switch(b.type){case"C":return new tableauSoftware.CategoricalFilter(a,b);case"RD":return new tableauSoftware.RelativeDateFilter(a,b);case"H":return new tableauSoftware.HierarchicalFilter(a,b);case"Q":return new tableauSoftware.QuantitativeFilter(a,b)}return null},tableauSoftware.Filter.$8=function(a,b){for(var c=new h._Collection,d=e.IEnumerator.getEnumerator(b.filters);d.moveNext();){var f=d.current,g=tableauSoftware.Filter.$7(a,f);c._add(f.caption,g)}return c},tableauSoftware.Filter.$9=function(a){switch(a){case"dimension":return"dimension";case"measure":return"measure"}return"unknown"},tableauSoftware.Filter.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,getFilterType:function(){return this.$1},getFieldName:function(){return this.$2},getWorksheet:function(){return this.$0.get_worksheet()},getFieldAsync:function(){var a=new h._Deferred;if(null==this.$3){var b=function(b){return a.reject(b),null},c=e.Delegate.create(this,function(b){return this.$3=new tableauSoftware.Field(b,this.$2,this.$5,this.$6),a.resolve(this.$3),null});this.$0.$12(this.$4).then(c,b)}else window.setTimeout(e.Delegate.create(this,function(){a.resolve(this.$3)}),0);return a.get_promise()},_update:function(a){this.$A(a),this._updateFromJson(a)},_addFieldParams:function(){},$A:function(a){switch(this.$2=a.caption,a.type){case"C":this.$1="categorical";break;case"RD":this.$1="relativedate";break;case"H":this.$1="hierarchical";break;case"Q":this.$1="quantitative"}this.$3=null,this.$4=a.datasourceName,this.$5=tableauSoftware.Filter.$9(a.fieldRoleType),this.$6=h.JavaScriptApi$3.$9(a.fieldAggrType)}},h.FilterEvent=function(a,b,c,d,e){h.FilterEvent.initializeBase(this,[a,b,c]),this.$3=e,this.$4=new h.JavaScriptApi$5(b._impl.get__workbookImpl(),c,d,e)},h.FilterEvent.prototype={$3:null,$4:null,getFieldName:function(){return this.$3},getFilterAsync:function(){return this.$4.get__worksheetImpl().$17(this.$4.get__filterFieldName(),null,null)}},h.JavaScriptApi$5=function(a,b,c,d){h.JavaScriptApi$5.initializeBase(this,[a,b]),this.$2=c,this.$3=d},h.JavaScriptApi$5.prototype={$2:null,$3:null,get__filterFieldName:function(){return this.$2},get_$4:function(){return this.$3}},tableauSoftware.HierarchicalFilter=function(a,b){tableauSoftware.HierarchicalFilter.initializeBase(this,[a,b]),this.$C(b)},tableauSoftware.HierarchicalFilter.prototype={$B:0,_addFieldParams:function(a){a["api.filterHierarchicalLevels"]=this.$B},_updateFromJson:function(a){this.$C(a)},$C:function(a){this.$B=a.levels}},tableauSoftware.QuantitativeFilter=function(a,b){tableauSoftware.QuantitativeFilter.initializeBase(this,[a,b]),this.$10(b)},tableauSoftware.QuantitativeFilter.prototype={$B:null,$C:null,$D:null,$E:null,$F:!1,getMin:function(){return this.$D},getMax:function(){return this.$E},getIncludeNullValues:function(){return this.$F},getDomainMin:function(){return this.$B},getDomainMax:function(){return this.$C},_updateFromJson:function(a){this.$10(a)},$10:function(a){this.$B=h._Utility.getDataValue(a.domainMinValue),this.$C=h._Utility.getDataValue(a.domainMaxValue),this.$D=h._Utility.getDataValue(a.minValue),this.$E=h._Utility.getDataValue(a.maxValue),this.$F=a.includeNullValues}},tableauSoftware.RelativeDateFilter=function(a,b){tableauSoftware.RelativeDateFilter.initializeBase(this,[a,b]),this.$E(b)},tableauSoftware.RelativeDateFilter.prototype={$B:null,$C:null,$D:0,getPeriod:function(){return this.$B},getRange:function(){return this.$C},getRangeN:function(){return this.$D},_updateFromJson:function(a){this.$E(a)},$E:function(a){e.isValue(a.periodType)&&(this.$B=h._Enums.$0(a.periodType,"periodType")),e.isValue(a.rangeType)&&(this.$C=h._Enums.$1(a.rangeType,"rangeType")),e.isValue(a.rangeN)&&(this.$D=a.rangeN)}},h._LoadFeedback=function(){},h._LoadFeedback.prototype={$0:null,$1:null,$2:null,$3:function(a){this.$0=a.$0;var b=this.$0.style;this.$2=b.display,b.position="relative",b.overflow="hidden",b.display="none";var c=[];c.push('<div style="position: absolute; top: 0; left: 0; right: 0; bottom: 0; border: 0; padding: 0; margin: 0">'),c.push("</div>");var d=document.createElement("div");d.innerHTML=c.join(""),this.$1=d.firstChild,this.$0.appendChild(this.$1),d.innerHTML="",d=null},$4:function(){e.isValue(this.$0)&&(this.$0.style.display=this.$2)},$5:function(){e.isValue(this.$1)&&(this.$1.innerHTML="",this.$1.parentNode.removeChild(this.$1),this.$1=null)}},tableauSoftware.Mark=function(a){this.$0=new h._MarkImpl(a)},tableauSoftware.Mark.prototype={$0:null,getPairs:function(){return this.$0.get_$5()}},h.MarksEvent=function(a,b,c){h.MarksEvent.initializeBase(this,[a,b,c]),this.$3=new h.JavaScriptApi$8(b._impl.get__workbookImpl(),c)},h.MarksEvent.prototype={$3:null,getMarksAsync:function(){var a=this.$3.get__worksheetImpl();if(e.isValue(a.get_selectedMarks())){var b=new h._Deferred;return b.resolve(a.get_selectedMarks()._toApiCollection())}return a.$2A()}},h.JavaScriptApi$8=function(a,b){h.JavaScriptApi$8.initializeBase(this,[a,b])},tableauSoftware.Pair=function(a,b){this.fieldName=a,this.value=b,this.formattedValue=e.isValue(b)?b.toString():""},tableauSoftware.Pair.prototype={fieldName:null,value:null,formattedValue:null},tableauSoftware.Parameter=function(a){this._impl=a},tableauSoftware.Parameter.prototype={_impl:null,getName:function(){return this._impl.get_$B()},getCurrentValue:function(){return this._impl.get_$C()},getDataType:function(){return this._impl.get_$D()},getAllowableValuesType:function(){return this._impl.get_$E()},getAllowableValues:function(){return this._impl.get_$F()},getMinValue:function(){return this._impl.get_$10()},getMaxValue:function(){return this._impl.get_$11()},getStepSize:function(){return this._impl.get_$12()},getDateStepPeriod:function(){return this._impl.get_$13()}},h.ParameterEvent=function(a,b,c){h.ParameterEvent.initializeBase(this,[a,b]),this.$2=new h.JavaScriptApi$7(b._impl.get__workbookImpl(),c)},h.ParameterEvent.prototype={$2:null,getParameterName:function(){return this.$2.get__parameterName()},getParameterAsync:function(){return this.$2.get__workbookImpl().$25(this.$2.get__parameterName())}},h.JavaScriptApi$7=function(a,b){h.JavaScriptApi$7.initializeBase(this,[a,null]),this.$2=b},h.JavaScriptApi$7.prototype={$2:null,get__parameterName:function(){return this.$2}},tableauSoftware.Sheet=function(a){h._Param.verifyValue(a,"sheetImpl"),this._impl=a},tableauSoftware.Sheet.prototype={_impl:null,getName:function(){return this._impl.get_name()},getIndex:function(){return this._impl.get_index()},getWorkbook:function(){return this._impl.get_workbookImpl().get_workbook()},getSize:function(){return this._impl.get_size()},getIsHidden:function(){return this._impl.get_isHidden()},getIsActive:function(){return this._impl.get_isActive()},getSheetType:function(){return this._impl.get_sheetType()},getUrl:function(){return this._impl.get_url()},changeSizeAsync:function(a){return this._impl.changeSizeAsync(a)}},tableauSoftware.SheetInfo=function(a){this.$0=a},tableauSoftware.SheetInfo.prototype={$0:null,getName:function(){return this.$0.name},getSheetType:function(){return this.$0.sheetType},getSize:function(){return this.$0.size},getIndex:function(){return this.$0.index},getUrl:function(){return this.$0.url},getIsActive:function(){return this.$0.isActive},getIsHidden:function(){return this.$0.isHidden},getWorkbook:function(){return this.$0.workbook}},h.SheetSizeFactory=function(){},h.SheetSizeFactory.createAutomatic=function(){var a=h.$create_SheetSize("automatic",null,null);return a},tableauSoftware.Story=function(a){tableauSoftware.Story.initializeBase(this,[a])},tableauSoftware.Story.prototype={_impl:null,getActiveStoryPoint:function(){return this._impl.get_activeStoryPointImpl().get_storyPoint()},getStoryPointsInfo:function(){return this._impl.get_storyPointsInfo()},activatePreviousStoryPointAsync:function(){return this._impl.activatePreviousStoryPointAsync()},activateNextStoryPointAsync:function(){return this._impl.activateNextStoryPointAsync()},activateStoryPointAsync:function(a){return this._impl.activateStoryPointAsync(a)},revertStoryPointAsync:function(a){return this._impl.revertStoryPointAsync(a)}},tableauSoftware.StoryPoint=function(a){this.$0=a},tableauSoftware.StoryPoint.prototype={$0:null,getCaption:function(){return this.$0.get_caption()},getContainedSheet:function(){return e.isValue(this.$0.get_containedSheetImpl())?this.$0.get_containedSheetImpl().get_sheet():null},getIndex:function(){return this.$0.get_index()},getIsActive:function(){return this.$0.get_isActive()},getIsUpdated:function(){return this.$0.get_isUpdated()},getParentStory:function(){return this.$0.get_parentStoryImpl().get_story()}},tableauSoftware.StoryPointInfo=function(a){this._impl=a},tableauSoftware.StoryPointInfo.prototype={_impl:null,getCaption:function(){return this._impl.caption},getIndex:function(){return this._impl.index},getIsActive:function(){return this._impl.isActive},getIsUpdated:function(){return this._impl.isUpdated},getParentStory:function(){return this._impl.parentStoryImpl.get_story()}},h.StoryPointSwitchEvent=function(a,b,c,d){h.StoryPointSwitchEvent.initializeBase(this,[a,b]),this.$2=c,this.$3=d},h.StoryPointSwitchEvent.prototype={$2:null,$3:null,getOldStoryPointInfo:function(){return this.$2},getNewStoryPoint:function(){return this.$3}},h.TableauEvent=function(a,b){this.$0=b,this.$1=a},h.TableauEvent.prototype={$0:null,$1:null,getViz:function(){return this.$0},getEventName:function(){return this.$1}},h.EventContext=function(a,b){this.$0=a,this.$1=b},h.EventContext.prototype={$0:null,$1:null,get__workbookImpl:function(){return this.$0},get__worksheetImpl:function(){return this.$1}},h.TabSwitchEvent=function(a,b,c,d){h.TabSwitchEvent.initializeBase(this,[a,b]),this.$2=c,this.$3=d},h.TabSwitchEvent.prototype={$2:null,$3:null,getOldSheetName:function(){return this.$2},getNewSheetName:function(){return this.$3}},tableauSoftware.Viz=function(a,b,c){var d=h._ApiObjectRegistry.getCrossDomainMessageRouter();this._impl=new h.VizImpl(d,this,a,b,c),this._impl.$3A()},tableauSoftware.Viz.prototype={_impl:null,getAreTabsHidden:function(){return this._impl.get_$22()},getIsToolbarHidden:function(){return this._impl.get_$23()},getIsHidden:function(){return this._impl.get_$24()},getParentElement:function(){return this._impl.get_$25()},getUrl:function(){return this._impl.get_$26()},getWorkbook:function(){return this._impl.get_$27()},getAreAutomaticUpdatesPaused:function(){return this._impl.get_$28()},addEventListener:function(a,b){this._impl.addEventListener(a,b)},removeEventListener:function(a,b){this._impl.removeEventListener(a,b)},dispose:function(){this._impl.$29()},show:function(){this._impl.$2A()},hide:function(){this._impl.$2B()},showExportDataDialog:function(a){this._impl.$2D(a)},showExportCrossTabDialog:function(a){this._impl.$2E(a)},showExportImageDialog:function(){this._impl.$2C()},showExportPDFDialog:function(){this._impl.$2F()},revertAllAsync:function(){return this._impl.$30()},refreshDataAsync:function(){return this._impl.$31()},showShareDialog:function(){this._impl.$32()},showDownloadWorkbookDialog:function(){this._impl.$33()},pauseAutomaticUpdatesAsync:function(){return this._impl.$34()},resumeAutomaticUpdatesAsync:function(){return this._impl.$35()},toggleAutomaticUpdatesAsync:function(){return this._impl.$36()},setFrameSize:function(a,b){var c=a,d=b;h._Utility.isNumber(a)&&(c=a+"px"),h._Utility.isNumber(b)&&(d=b+"px"),this._impl.$37(c,d)}},tableauSoftware.VizManager=function(){},tableauSoftware.VizManager.getVizs=function(){return h._VizManagerImpl.get_$1()},tableauSoftware.Workbook=function(a){this.$0=a},tableauSoftware.Workbook.prototype={$0:null,getViz:function(){return this.$0.get_viz()},getPublishedSheetsInfo:function(){return this.$0.get_publishedSheets()._toApiCollection()},getName:function(){return this.$0.get_name()},getActiveSheet:function(){return this.$0.get_activeSheetImpl().get_sheet()},getActiveCustomView:function(){return this.$0.get_activeCustomView()},activateSheetAsync:function(a){return this.$0._setActiveSheetAsync(a)},revertAllAsync:function(){return this.$0._revertAllAsync()},getCustomViewsAsync:function(){return this.$0.$1C()},showCustomViewAsync:function(a){return this.$0.$1D(a)},removeCustomViewAsync:function(a){return this.$0.$1E(a)},rememberCustomViewAsync:function(a){return this.$0.$1F(a)},setActiveCustomViewAsDefaultAsync:function(){return this.$0.$20()},getParametersAsync:function(){return this.$0.$26()},changeParameterValueAsync:function(a,b){return this.$0.$27(a,b)}},tableauSoftware.Worksheet=function(a){tableauSoftware.Worksheet.initializeBase(this,[a])},tableauSoftware.Worksheet.prototype={_impl:null,getParentDashboard:function(){return this._impl.get_parentDashboard()},getParentStoryPoint:function(){return this._impl.get_parentStoryPoint()},getDataSourcesAsync:function(){return this._impl.$11()},getFilterAsync:function(a,b){return this._impl.$17(null,a,b)},getFiltersAsync:function(a){return this._impl.$18(a)},applyFilterAsync:function(a,b,c,d){return this._impl.$19(a,b,c,d)},clearFilterAsync:function(a){return this._impl.$1A(a)},applyRangeFilterAsync:function(a,b){return this._impl.$1B(a,b)},applyRelativeDateFilterAsync:function(a,b){return this._impl.$1C(a,b)},applyHierarchicalFilterAsync:function(a,b,c,d){return this._impl.$1D(a,b,c,d)},clearSelectedMarksAsync:function(){return this._impl.$28()},selectMarksAsync:function(a,b,c){return this._impl.$29(a,b,c)},getSelectedMarksAsync:function(){return this._impl.$2A()}},h.WorksheetEvent=function(a,b,c){h.WorksheetEvent.initializeBase(this,[a,b]),this.$2=c},h.WorksheetEvent.prototype={$2:null,getWorksheet:function(){return this.$2.get_worksheet()}},h._jQueryShim=function(){},h._jQueryShim.$11=function(a){return"function"===h._jQueryShim.$13(a)},h._jQueryShim.$12=function(a){return e.isValue(Array.isArray)?Array.isArray(a):"array"===h._jQueryShim.$13(a)},h._jQueryShim.$13=function(a){return null==a?String(a):h._jQueryShim.$8[h._jQueryShim.$A.call(a)]||"object"},h._jQueryShim.$14=function(a){return e.isValue(h._jQueryShim.$9)?null==a?"":h._jQueryShim.$9.call(a):null==a?"":a.replace(h._jQueryShim.$B,"").replace(h._jQueryShim.$C,"")},h._jQueryShim.parseJSON=function(a){if("string"!=typeof a||e.isNullOrUndefined(a))return null;if(a=h._jQueryShim.$14(a),window.JSON&&window.JSON.parse)return window.JSON.parse(a);if(h._jQueryShim.$D.test(a.replace(h._jQueryShim.$E,"@").replace(h._jQueryShim.$F,"]").replace(h._jQueryShim.$10,"")))return new Function("return "+a)();throw new Error("Invalid JSON: "+a)},h._ApiCommand.registerClass("tab._ApiCommand"),h._ApiServerResultParser.registerClass("tab._ApiServerResultParser"),h.JavaScriptApi$4.registerClass("tab.JavaScriptApi$4"),h._CommandReturnHandler.registerClass("tab._CommandReturnHandler"),h.JavaScriptApi$1.registerClass("tab.JavaScriptApi$1",null,h.ICrossDomainMessageRouter),h.JavaScriptApi$0.registerClass("tab.JavaScriptApi$0",null,h.ICrossDomainMessageHandler),h.CrossDomainMessagingOptions.registerClass("tab.CrossDomainMessagingOptions"),h._Enums.registerClass("tab._Enums"),h._ApiBootstrap.registerClass("tab._ApiBootstrap"),h._ApiObjectRegistry.registerClass("tab._ApiObjectRegistry"),h._CustomViewImpl.registerClass("tab._CustomViewImpl"),h._SheetImpl.registerClass("tab._SheetImpl"),h._DashboardImpl.registerClass("tab._DashboardImpl",h._SheetImpl),h.JavaScriptApi$3.registerClass("tab.JavaScriptApi$3"),h._DeferredUtil.registerClass("tab._DeferredUtil"),h._CollectionImpl.registerClass("tab._CollectionImpl"),h._DeferredImpl.registerClass("tab._DeferredImpl"),h._PromiseImpl.registerClass("tab._PromiseImpl"),h._MarkImpl.registerClass("tab._MarkImpl"),h._Param.registerClass("tab._Param"),h._ParameterImpl.registerClass("tab._ParameterImpl"),h._StoryImpl.registerClass("tab._StoryImpl",h._SheetImpl),h._StoryPointImpl.registerClass("tab._StoryPointImpl"),h.StoryPointInfoImplUtil.registerClass("tab.StoryPointInfoImplUtil"),h._TableauException.registerClass("tab._TableauException"),h._Utility.registerClass("tab._Utility"),h.VizImpl.registerClass("tab.VizImpl",null,h.ICrossDomainMessageHandler),h._VizManagerImpl.registerClass("tab._VizManagerImpl"),h._VizParameters.registerClass("tab._VizParameters"),h._WorkbookImpl.registerClass("tab._WorkbookImpl"),h._WorksheetImpl.registerClass("tab._WorksheetImpl",h._SheetImpl),h.JsonUtil.registerClass("tab.JsonUtil"),tableauSoftware.CustomView.registerClass("tableauSoftware.CustomView"),h.TableauEvent.registerClass("tab.TableauEvent"),h.CustomViewEvent.registerClass("tab.CustomViewEvent",h.TableauEvent),h.EventContext.registerClass("tab.EventContext"),h.JavaScriptApi$6.registerClass("tab.JavaScriptApi$6",h.EventContext),tableauSoftware.Sheet.registerClass("tableauSoftware.Sheet"),tableauSoftware.Dashboard.registerClass("tableauSoftware.Dashboard",tableauSoftware.Sheet),tableauSoftware.DashboardObject.registerClass("tableauSoftware.DashboardObject"),tableauSoftware.DataSource.registerClass("tableauSoftware.DataSource"),tableauSoftware.Field.registerClass("tableauSoftware.Field"),tableauSoftware.Filter.registerClass("tableauSoftware.Filter"),tableauSoftware.CategoricalFilter.registerClass("tableauSoftware.CategoricalFilter",tableauSoftware.Filter),h.WorksheetEvent.registerClass("tab.WorksheetEvent",h.TableauEvent),h.FilterEvent.registerClass("tab.FilterEvent",h.WorksheetEvent),h.JavaScriptApi$5.registerClass("tab.JavaScriptApi$5",h.EventContext),tableauSoftware.HierarchicalFilter.registerClass("tableauSoftware.HierarchicalFilter",tableauSoftware.Filter),tableauSoftware.QuantitativeFilter.registerClass("tableauSoftware.QuantitativeFilter",tableauSoftware.Filter),tableauSoftware.RelativeDateFilter.registerClass("tableauSoftware.RelativeDateFilter",tableauSoftware.Filter),h._LoadFeedback.registerClass("tab._LoadFeedback"),tableauSoftware.Mark.registerClass("tableauSoftware.Mark"),h.MarksEvent.registerClass("tab.MarksEvent",h.WorksheetEvent),h.JavaScriptApi$8.registerClass("tab.JavaScriptApi$8",h.EventContext),tableauSoftware.Pair.registerClass("tableauSoftware.Pair"),tableauSoftware.Parameter.registerClass("tableauSoftware.Parameter"),h.ParameterEvent.registerClass("tab.ParameterEvent",h.TableauEvent),h.JavaScriptApi$7.registerClass("tab.JavaScriptApi$7",h.EventContext),tableauSoftware.SheetInfo.registerClass("tableauSoftware.SheetInfo"),h.SheetSizeFactory.registerClass("tab.SheetSizeFactory"),tableauSoftware.Story.registerClass("tableauSoftware.Story",tableauSoftware.Sheet),tableauSoftware.StoryPoint.registerClass("tableauSoftware.StoryPoint"),tableauSoftware.StoryPointInfo.registerClass("tableauSoftware.StoryPointInfo"),h.StoryPointSwitchEvent.registerClass("tab.StoryPointSwitchEvent",h.TableauEvent),h.TabSwitchEvent.registerClass("tab.TabSwitchEvent",h.TableauEvent),tableauSoftware.Viz.registerClass("tableauSoftware.Viz"),tableauSoftware.VizManager.registerClass("tableauSoftware.VizManager"),tableauSoftware.Workbook.registerClass("tableauSoftware.Workbook"),tableauSoftware.Worksheet.registerClass("tableauSoftware.Worksheet",tableauSoftware.Sheet),h._jQueryShim.registerClass("tab._jQueryShim"),h._ApiCommand.crossDomainEventNotificationId="xdomainSourceId",h._ApiObjectRegistry.$1=null,h._ApiObjectRegistry.$2=null,h.JavaScriptApi$3.$0={sum:"SUM",average:"AVG",min:"MIN",max:"MAX","std-dev":"STDEV","std-dev-p":"STDEVP","var":"VAR","var-p":"VARP",count:"COUNT","count-d":"COUNTD",median:"MEDIAN",attr:"ATTR",none:"NONE",year:"YEAR",qtr:"QTR",month:"MONTH",day:"DAY",hour:"HOUR",minute:"MINUTE",second:"SECOND",week:"WEEK",weekday:"WEEKDAY","month-year":"MONTHYEAR",mdy:"MDY",end:"END","trunc-year":"TRUNC_YEAR","trunc-qtr":"TRUNC_QTR","trunc-month":"TRUNC_MONTH","trunc-week":"TRUNC_WEEK","trunc-day":"TRUNC_DAY","trunc-hour":"TRUNC_HOUR","trunc-minute":"TRUNC_MINUTE","trunc-second":"TRUNC_SECOND",quart1:"QUART1",quart3:"QUART3",skewness:"SKEWNESS",kurtosis:"KURTOSIS","in-out":"INOUT","sum-xsqr":"SUM_XSQR",user:"USER"},h._SheetImpl.noZoneId=4294967295,h._VizManagerImpl.$0=[],h._WorksheetImpl.$26=new RegExp("\\[[^\\]]+\\]\\.","g"),h._jQueryShim.$8={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"},h._jQueryShim.$9=String.prototype.trim,h._jQueryShim.$A=Object.prototype.toString,h._jQueryShim.$B=new RegExp("^[\\s\\xA0]+"),h._jQueryShim.$C=new RegExp("[\\s\\xA0]+$"),h._jQueryShim.$D=new RegExp("^[\\],:{}\\s]*$"),h._jQueryShim.$E=new RegExp('\\\\(?:["\\\\\\/bfnrt]|u[0-9a-fA-F]{4})',"g"),h._jQueryShim.$F=new RegExp('"[^"\\\\\\n\\r]*"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?',"g"),h._jQueryShim.$10=new RegExp("(?:^|:|,)(?:\\s*\\[)+","g"),tableauSoftware.Promise=h._PromiseImpl,h._Deferred=h._DeferredImpl,h._Collection=h._CollectionImpl,tableauSoftware.DashboardObjectType={BLANK:"blank",WORKSHEET:"worksheet",QUICK_FILTER:"quickFilter",PARAMETER_CONTROL:"parameterControl",PAGE_FILTER:"pageFilter",LEGEND:"legend",TITLE:"title",TEXT:"text",IMAGE:"image",WEB_PAGE:"webPage"},tableauSoftware.FilterType={CATEGORICAL:"categorical",QUANTITATIVE:"quantitative",HIERARCHICAL:"hierarchical",RELATIVEDATE:"relativedate"},tableauSoftware.ParameterDataType={FLOAT:"float",INTEGER:"integer",STRING:"string",BOOLEAN:"boolean",DATE:"date",DATETIME:"datetime"},tableauSoftware.ParameterAllowableValuesType={ALL:"all",LIST:"list",RANGE:"range"},tableauSoftware.PeriodType={YEAR:"year",QUARTER:"quarter",MONTH:"month",WEEK:"week",DAY:"day",HOUR:"hour",MINUTE:"minute",SECOND:"second"},tableauSoftware.DateRangeType={LAST:"last",LASTN:"lastn",NEXT:"next",NEXTN:"nextn",CURR:"curr",TODATE:"todate"},tableauSoftware.SheetSizeBehavior={AUTOMATIC:"automatic",EXACTLY:"exactly",RANGE:"range",ATLEAST:"atleast",ATMOST:"atmost"},tableauSoftware.SheetType={WORKSHEET:"worksheet",DASHBOARD:"dashboard",STORY:"story"},tableauSoftware.FilterUpdateType={ALL:"all",REPLACE:"replace",ADD:"add",REMOVE:"remove"},tableauSoftware.SelectionUpdateType={REPLACE:"replace",ADD:"add",REMOVE:"remove"},tableauSoftware.NullOption={NULL_VALUES:"nullValues",NON_NULL_VALUES:"nonNullValues",ALL_VALUES:"allValues"},tableauSoftware.ErrorCode={INTERNAL_ERROR:"internalError",SERVER_ERROR:"serverError",INVALID_AGGREGATION_FIELD_NAME:"invalidAggregationFieldName",INVALID_PARAMETER:"invalidParameter",INVALID_URL:"invalidUrl",STALE_DATA_REFERENCE:"staleDataReference",VIZ_ALREADY_IN_MANAGER:"vizAlreadyInManager",NO_URL_OR_PARENT_ELEMENT_NOT_FOUND:"noUrlOrParentElementNotFound",INVALID_FILTER_FIELDNAME:"invalidFilterFieldName",INVALID_FILTER_FIELDVALUE:"invalidFilterFieldValue",INVALID_FILTER_FIELDNAME_OR_VALUE:"invalidFilterFieldNameOrValue",FILTER_CANNOT_BE_PERFORMED:"filterCannotBePerformed",NOT_ACTIVE_SHEET:"notActiveSheet",INVALID_CUSTOM_VIEW_NAME:"invalidCustomViewName",MISSING_RANGEN_FOR_RELATIVE_DATE_FILTERS:"missingRangeNForRelativeDateFilters",MISSING_MAX_SIZE:"missingMaxSize",MISSING_MIN_SIZE:"missingMinSize",MISSING_MINMAX_SIZE:"missingMinMaxSize",INVALID_SIZE:"invalidSize",INVALID_SIZE_BEHAVIOR_ON_WORKSHEET:"invalidSizeBehaviorOnWorksheet",SHEET_NOT_IN_WORKBOOK:"sheetNotInWorkbook",INDEX_OUT_OF_RANGE:"indexOutOfRange",DOWNLOAD_WORKBOOK_NOT_ALLOWED:"downloadWorkbookNotAllowed",NULL_OR_EMPTY_PARAMETER:"nullOrEmptyParameter",BROWSER_NOT_CAPABLE:"browserNotCapable",UNSUPPORTED_EVENT_NAME:"unsupportedEventName",INVALID_DATE_PARAMETER:"invalidDateParameter",INVALID_SELECTION_FIELDNAME:"invalidSelectionFieldName",INVALID_SELECTION_VALUE:"invalidSelectionValue",INVALID_SELECTION_DATE:"invalidSelectionDate",NO_URL_FOR_HIDDEN_WORKSHEET:"noUrlForHiddenWorksheet"},tableauSoftware.TableauEventName={CUSTOM_VIEW_LOAD:"customviewload",CUSTOM_VIEW_REMOVE:"customviewremove",CUSTOM_VIEW_SAVE:"customviewsave",CUSTOM_VIEW_SET_DEFAULT:"customviewsetdefault",FILTER_CHANGE:"filterchange",FIRST_INTERACTIVE:"firstinteractive",MARKS_SELECTION:"marksselection",PARAMETER_VALUE_CHANGE:"parametervaluechange",STORY_POINT_SWITCH:"storypointswitch",TAB_SWITCH:"tabswitch"},tableauSoftware.FieldRoleType={DIMENSION:"dimension",MEASURE:"measure",UNKNOWN:"unknown"},tableauSoftware.FieldAggregationType={SUM:"SUM",AVG:"AVG",MIN:"MIN",MAX:"MAX",STDEV:"STDEV",STDEVP:"STDEVP",VAR:"VAR",VARP:"VARP",COUNT:"COUNT",COUNTD:"COUNTD",MEDIAN:"MEDIAN",ATTR:"ATTR",NONE:"NONE",YEAR:"YEAR",QTR:"QTR",MONTH:"MONTH",DAY:"DAY",HOUR:"HOUR",MINUTE:"MINUTE",SECOND:"SECOND",WEEK:"WEEK",WEEKDAY:"WEEKDAY",MONTHYEAR:"MONTHYEAR",MDY:"MDY",END:"END",TRUNC_YEAR:"TRUNC_YEAR",TRUNC_QTR:"TRUNC_QTR",TRUNC_MONTH:"TRUNC_MONTH",TRUNC_WEEK:"TRUNC_WEEK",TRUNC_DAY:"TRUNC_DAY",TRUNC_HOUR:"TRUNC_HOUR",TRUNC_MINUTE:"TRUNC_MINUTE",TRUNC_SECOND:"TRUNC_SECOND",QUART1:"QUART1",QUART3:"QUART3",SKEWNESS:"SKEWNESS",KURTOSIS:"KURTOSIS",INOUT:"INOUT",SUM_XSQR:"SUM_XSQR",USER:"USER"},tableauSoftware.ToolbarPosition={TOP:"top",BOTTOM:"bottom"},d(),h._ApiBootstrap.initialize()
}();var serverName="tableau.russellchristopher.org",mainViz,mainWorkbook,newCustomView,dataSources,agora=window.agora||{};!function(){agora.vizfuncs={reportUrl:"",h1:"",h2:"",pages:"",url:"",mainViz:"",routeParams:"",vizParams:[],mainVizDiv:"#mainViz",div:"",history:[],filters:{},customViewName:0,counter:0,filterCounter:0,customUrl:"",historyCounter:0,pageId:"report",filterHistory:[],parameterHistory:[],tabHistory:[],locked:!1,goingBack:!1,renderViz:function(a){this.customViewName=0,this.routeParams=a,this.getReportUrl(a),this.div=$(this.mainVizDiv);var b=this.url,c={hideTabs:!0,hideToolbar:!0,width:this.div.parent().innerWidth()+"px",height:this.div.parent().innerHeight()+"px",onFirstInteractive:function(){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook()}},d=$.extend({},c,this.getVizOptions());this.mainViz=new tableauSoftware.Viz(this.div[0],b,d),console.log(this.div[0]),console.log(b),console.log(d)},resizeViz:function(){var a=$("#mainViz").height(),b=$("#mainViz").width();agora.vizfuncs.mainViz.setFrameSize(b,a),console.log(agora.vizfuncs.mainViz.getIsHidden())},showDownloadWorkbookDialog:function(){agora.vizfuncs.mainViz.showDownloadWorkbookDialog()},showExportPDFDialog:function(){agora.vizfuncs.mainViz.showExportPDFDialog()},showShareDialog:function(){agora.vizfuncs.mainViz.showShareDialog()},showExportDataDialog:function(){agora.vizfuncs.mainViz.showExportDataDialog()},showExportImageDialog:function(){agora.vizfuncs.mainViz.showExportImageDialog()},showExportCrossTabDialog:function(){agora.vizfuncs.mainViz.showExportCrossTabDialog()},revertAll:function(){agora.vizfuncs.mainViz.revertAllAsync()},getVizOptions:function(){return this.vizParams},setVizParams:function(a,b){var c={};c[a]=b,agora.vizfuncs.vizParams.push(c)},getReportUrl:function(a){var b=a.report,c=a.id,d=$.grep(pagesObj.repGroup,function(a){return a.groupName==c});return"undefined"==typeof d[0]?(console.log("not found"),!1):(this.pages=d,this.h2=d[0].pages[b][0].pageSubheading,this.url=pagesObj.reportsBaseUrl+d[0].pages[b][0].url,void 0)},setReportTitle:function(a){this.getReportUrl(this.routeParams);var b=[];$.each(this.pages[0].pages,function(a,c){b.push(c)}),$.each(b,function(b,c){$.each(c,function(b,c){c.pageId==a&&(agora.vizfuncs.pageId=c.pageId,agora.vizfuncs.h1=c.pageHeading,agora.vizfuncs.h2=c.pageSubheading)})})},addEventListeners:function(){this.mainViz.addEventListener("tabswitch",this._ventOnTabSwitch),this.mainViz.addEventListener("parametervaluechange",this._ventOnParameterChanged),this.mainViz.addEventListener("filterchange",this._ventOnFilterChanged)},_ventOnTabSwitch:function(a){var b=a.getOldSheetName();agora.vizfuncs.recordLastTab(b);var c=agora.vizfuncs.mainViz.getWorkbook().getActiveSheet().getName();agora.vizfuncs.setReportTitle(c),agora.vizfuncs.onChange()},recordLastTab:function(a){var b=agora.vizfuncs;if(b.goingBack)return void(b.goingBack=!1);var c=b.history[b.historyCounter-1];c.tabName=a,b.tabHistory.push(c),b.goingBack=!1},_ventOnParameterChanged:function(){agora.vizfuncs.onChange()},_ventOnFilterChanged:function(){agora.vizfuncs.filterCounter>0||(agora.vizfuncs.onChange(),agora.vizfuncs.filterCounter++,setTimeout(function(){agora.vizfuncs.filterCounter--},3e3))},recordHistory:function(){var a=agora.vizfuncs,b=a.customViewName.toString();a.saveCustomView(b),a.customViewName++},onBackOld:function(){var a=agora.vizfuncs;return a.customViewName--,a.customViewName<=-0?void console.log("no more history"):(console.log("View Name: "+a.customViewName),a.showCustomView(a.customViewName.toString()),void a.removeCustomView(a.customViewName))},applyParams:function(a){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook(),$.each(a[0],function(a,b){mainWorkbook.changeParameterValueAsync(b.name,b.values[1])})},applyFilters:function(a){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook();var b=mainWorkbook.getActiveSheet(),c=b.getWorksheets(),d=c[1],b=mainWorkbook.getActiveSheet();$.each(a[0],function(a,b){d.applyFilterAsync(b.name,b.values,"REPLACE")})},getLastHistoryState:function(){var a=agora.vizfuncs;a.historyCounter--;var b=a.history[a.historyCounter-1];return b},onBackAll:function(){console.log("going back");var a=agora.vizfuncs;a.locked=!0;var b=agora.vizfuncs.getLastHistoryState();a.applyParams(b.params),a.applyFilters(b.filters)},onBack:function(){var a=agora.vizfuncs;a.locked=!0,a.goingBack=!0,a.ba;var b=a.tabHistory[Object.keys(a.tabHistory)[Object.keys(a.tabHistory).length-1]];a.tabHistory.pop(),a.changeTab(b)},changeTab:function(a){var b=agora.vizfuncs;mainWorkbook=b.mainViz.getWorkbook();var c=a.tabName,d=a.filters,e=a.params;mainWorkbook.activateSheetAsync(c),b.applyParams(e),b.applyFilters(d),b.tabHistory.pop()},onChange:function(){if(agora.vizfuncs.locked)return console.log("locked"),void(agora.vizfuncs.locked=!1);if(console.log("not locked"),agora.vizfuncs.counter<=0){console.log("setting report title");var a=agora.vizfuncs.mainViz.getWorkbook().getActiveSheet().getName();agora.vizfuncs.setReportTitle(a),agora.vizfuncs.counter++}agora.vizfuncs.filterHistory=[],agora.vizfuncs.parameterHistory=[],agora.vizfuncs.getFilters(),agora.vizfuncs.getParameters();var b={report:agora.vizfuncs.pageId,filters:agora.vizfuncs.filterHistory,params:agora.vizfuncs.parameterHistory};agora.vizfuncs.history.push(b),agora.vizfuncs.historyCounter++},getParameters:function(){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook();var a=[],b=[],c=function(c){window.params=c,$.each(c,function(c,d){$.each(d.getCurrentValue(),function(a,c){b.push(c)});var e={name:d.getName(),values:b};b=[],a.push(e)}),agora.vizfuncs.parameterHistory.push(a)},d=function(){console.log("Error!!")};mainWorkbook.getParametersAsync().then(c,d)},getFilters:function(){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook();var a=[],b=[],c=function(c){$.each(c,function(c,d){$.each(d.$C,function(a,c){b.push(c.formattedValue)});var e={name:d.$2,values:b};b=[],a.push(e)}),console.log("Pusihing to filterHistory"),agora.vizfuncs.filterHistory.push(a)},d=function(){console.log("Error!!")};mainWorkbook.getActiveSheet().getWorksheets()[0].getFiltersAsync().then(c,d)},createCustomViewName:function(){var a=this.customViewName;return this.customViewName++,a},getCustomViewName:function(){var a=agora.vizfuncs;return a.customViewName},saveCustomView:function(){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook()},showCustomView:function(a){console.log("Showing: "+a),mainWorkbook=agora.vizfuncs.mainViz.getWorkbook(),mainWorkbook.showCustomViewAsync(a.toString()).then(onSuccess,onError)},generateLink:function(){newCustomView.saveAsync().then(function(){return newCustomView.getUrl()})},removeCustomView:function(a){mainWorkbook=agora.vizfuncs.mainViz.getWorkbook(),mainWorkbook.removeCustomViewAsync(a.toString())}}}(),angular.module("agoraApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/reports/:id",{templateUrl:"views/section.html",controller:"SectionCtrl"}).when("/reports/:id/:report/:reportname",{templateUrl:"views/viz.html",controller:"VizCtrl"}).when("/reports",{templateUrl:"views/reports.html",controller:"ReportsCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({})}]),angular.module("agoraApp").controller("NavCtrl",["$scope","$route","$parse","$templateCache","$location",function(a,b,c,d,e){a.structure=agora.reports.getReportStructure(),a.groups=groups,window.lastSelected="",a.timer="",a.showSections=function(b,c){lastSelected=c,a.tierOne=Object.keys(groups[c]),a.tierOne.push(c),a.showTierOne="show-tier-one",a.marginLeft=b.offsetX-100+"px";var d=100;a.timer=setTimeout(function(){var a=b.offsetX-100+"px";$("#tier-one-ul").hide(),$("#tier-one-ul li:first").css("margin-left",a),$("#tier-one-ul").fadeIn(100)},d)},a.hideSections=function(){a.showTierOne="",$("#reports-tier").find("li:contains("+lastSelected+")").removeClass("persisting-hover")},a.persistSections=function(){clearTimeout(a.timer),a.showTierOne="show-tier-one",$("#reports-tier").find("li:contains("+lastSelected+")").addClass("persisting-hover")},a.isActive=function(a){var b=e.path().split("/"),c="#/"+b[1];return a===c},a.toggleTier=function(a,b){"show"==a?f(b):(g(b),g(".custom-tier3-bootstrap-menu-nav"))},a.reportSections={},a.reportSelect=function(a){var b=agora.reports.getPages(a);$(".reportSections").html("");var c="";angular.forEach(b,function(b,d){console.log("Key: "+d),c+="<li><a href='/#reports/"+a+"/"+d+"/report'>"+d+"</a></li>"}),$(".reportSections").append(c)};var f=function(a){$(a).css("opacity",1).slideDown("fast").animate({opacity:1},{queue:!1,duration:"slow"})},g=function(a){$(a).css("opacity",1).slideUp("fast").animate({opacity:1},{queue:!1,duration:"slow"})};a.groups=agora.reports.getGroups()}]),$(document).ready(function(){"#/reports"!=window.location.hash&&($("#reports-tier").addClass("reports-tier-hide"),$("#reports-tier ul").hide()),$(".nav-main").on("click",function(){var a=$(this).attr("id");"reports"==a?($("#reports-tier").removeClass("reports-tier-hide"),$("#reports-tier ul").show()):($("#reports-tier").addClass("reports-tier-hide"),$("#reports-tier ul").hide())})}),angular.module("agoraApp").controller("MainCtrl",["$scope","$templateCache",function(a){var b={search:function(a){var b=[];return $.each(a,function(a,c){b.push(c)}),b}};a.groups=b.search(pagesObj.repGroup,"The Register")}]),angular.module("agoraApp").controller("SectionCtrl",["$scope","$route","$parse","$location",function(a,b,c,d){a.sectionText="Hover over the left icons for more info",a.sectionName=agora.reports.sanitizeCategoryName(b.current.params.id),a.sectionDescription=agora.reports.getSectionDescription(a.sectionName),a.pages=agora.reports.getPages(b.current.params.id),a.getDescription=function(b){a.sectionText=b};a.sectionDescriptions=agora.reports.getSectionDescriptions(pagesObj,Object.keys(a.pages));$.each(groups,function(a){console.log(a)}),a.gotoViz=function(a){d.path(d.path()+"/"+a)}}]),angular.module("agoraApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("agoraApp").controller("ReportsCtrl",["$scope",function(a){var b=agora.reports.search(pagesObj,"repGroup");a.pages=b[2],a.bgClass="",a.defaultText="Please choose the data report you would like to explore",a.getDescription=function(b,c){a.defaultText=b;var d="/images/reports-"+c+".jpg";$(".reports-background").after().css({"background-image":'url("'+d+'")'});var e=["#2a3f61","#2ca7bf","#5a2a80","#b05898","#7c418c","#7a71ad","#4275b3"];$(".report-group-info-text").css({background:e[c],color:"#fff"})}}]),angular.module("agoraApp").controller("VizCtrl",["$scope","$routeParams",function(a,b){a.breadCrumbs=b,a.onBack=function(){agora.vizfuncs.onBack()};var c=function(){a.$apply(function(){a.h1=agora.vizfuncs.h1,a.h2=agora.vizfuncs.h2,a.info=agora.vizfuncs.pages[0].description,a.reportUrl=agora.vizfuncs.reportUrl,a.pages=agora.vizfuncs.pages,a.url=agora.vizfuncs.url})};agora.vizfuncs.renderViz(b,a),agora.vizfuncs.addEventListeners(),agora.vizfuncs.getReportUrl(b),setTimeout(function(){agora.vizfuncs.onChange()},5e3);var d=function(){agora.vizfuncs.tabHistory.length<=0?$("#undo").attr("disabled","disabled"):$("#undo").removeAttr("disabled")};d(),Object.observe(agora.vizfuncs,function(){c(),d()})}]),$(document).ready(function(){$("#reports-tier").removeClass("reports-tier-hide"),$("#reports-tier ul").show()}),function(a){"use strict";function b(a){return new RegExp("(^|\\s+)"+a+"(\\s+|$)")}function c(a,b){var c=d(a,b)?f:e;c(a,b)}var d,e,f;"classList"in document.documentElement?(d=function(a,b){return a.classList.contains(b)},e=function(a,b){a.classList.add(b)},f=function(a,b){a.classList.remove(b)}):(d=function(a,c){return b(c).test(a.className)},e=function(a,b){d(a,b)||(a.className=a.className+" "+b)},f=function(a,c){a.className=a.className.replace(b(c)," ")});var g={hasClass:d,addClass:e,removeClass:f,toggleClass:c,has:d,add:e,remove:f,toggle:c};"function"==typeof define&&define.amd?define(g):a.classie=g}(window),function(){"use strict";{var a,b=document.body,c=document.createElement("div");document.querySelector(".toggle-slide-left")}c.className="mask",c.addEventListener("click",function(){classie.remove(b,a),a="",document.body.removeChild(c)}),[].slice.call(document.querySelectorAll(".close-menu")).forEach(function(d){d.addEventListener("click",function(){classie.remove(b,a),a="",document.body.removeChild(c)})}),$(document).ready(function(){$(".close-menu").on("click",function(){classie.remove(b,a),a="",document.body.removeChild(c)}),setTimeout(function(){$(".toggle-slide-left").on("click",function(){classie.add(b,"sml-open"),document.body.appendChild(c),a="sml-open"})},250)})}(window);